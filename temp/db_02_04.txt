SQL> select *
  2  from emp
  3  where sal < any (select sal
  4  from emp where deptno = 30)
  5  order by sal, empno;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   

9 rows selected.

SQL> select job
  2  from emp
  3  where case job
  4  when 'MANAGER' then max(sal)
  5  else no end;
when 'MANAGER' then max(sal)
                    *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> select job,
  2  case job
  3  when 'MANAGER' then max(sal)
  4  when 'SALESMAN' then max(sal)
  5  else end AS JOB2
  6  from emp;
else end AS JOB2
         *
ERROR at line 5:
ORA-00905: missing keyword 


SQL> select job,
  2  case job
  3  when 'MANAGER' then max(sal)
  4  when 'SALESMAN' then max(sal)
  5  else end AS JOBB
  6  from emp;
else end AS JOBB
         *
ERROR at line 5:
ORA-00905: missing keyword 


SQL> select job,
  2  case job
  3  when 'MANAGER' then max(sal)
  4  when 'SALESMAN' then max(sal)
  5  else end as JOBBI
  6  from emp;
else end as JOBBI
         *
ERROR at line 5:
ORA-00905: missing keyword 


SQL> select job,
  2  case job
  3  when 'MANAGER' then max(sal)
  4  when 'SALESMAN' then max(sal)
  5  else end as jobi
  6  from emp;
else end as jobi
         *
ERROR at line 5:
ORA-00905: missing keyword 


SQL> select job,
  2  case job
  3  when 'MANAGER' then max(sal)
  4  when 'SALESMAN' then max(sal)
  5  else sal
  6  end as jobi
  7  from emp;
select job,
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> --ex9-14
SQL> select *
  2  from emp
  3  where sal < all (
  4  select sal
  5  from emp
  6  where deptno = 30);

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   

SQL> --ex9-15
SQL> select *
  2  from emp
  3  where sal > all (
  4  select sal
  5  from emp
  6  where deptno = 30);

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   

SQL> select *
  2  from emp
  3  where exists (
  4  select dname
  5  from dept
  6  where deptno = 10);

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> select job, max(sal)
  2  from emp
  3  where job = 'MANAGER';
select job, max(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select job, max(sal)
  2  from emp
  3  where job in 'MANAGER';
select job, max(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select max(sal)
  2  from emp
  3  where job = 'MANAGER';

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      2975                                                                                                                                                                                                                                                

SQL> select job, max(sal)
  2  from emp;
select job, max(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select job, max(sal)
  2  from emp
  3  where job = 'MANAGER';
select job, max(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select max(sal)
  2  from emp;

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      5000                                                                                                                                                                                                                                                

SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> select max(sal)
  2  from emp
  3  where job in ('MANAGER', 'CLERK', 'SALESMAN');

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      2975                                                                                                                                                                                                                                                

SQL> select *
  2  from emp
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename =JONES);
where ename =JONES)
             *
ERROR at line 6:
ORA-00904: "JONES": invalid identifier 


SQL> select *
  2  from emp
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename = 'JONES');

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   

SQL> select *
  2  from emp
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename = 'JONES');

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   

SQL> select deptno
  2  from emp
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename = 'JONES');

    DEPTNO                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
        20                                                                                                                                                                                                                                                
        20                                                                                                                                                                                                                                                
        20                                                                                                                                                                                                                                                
        20                                                                                                                                                                                                                                                
        20                                                                                                                                                                                                                                                

SQL> select deptno
  2  from emp
  3  where ename = 'JONES';

    DEPTNO                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
        20                                                                                                                                                                                                                                                

SQL> select *
  2  from dept;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> select *
  2  from dept
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename = 'JONES');

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          

SQL> select deptno, dname
  2  from dept
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename = 'JONES');

    DEPTNO DNAME                                                                                                                                                                                                                                          
---------- ------------------------------                                                                                                                                                                                                                 
        20 RESEARCH                                                                                                                                                                                                                                       

SQL> select e10.empno, e10.ename, e10.deptno, d.dname, d.loc
  2  from (
  3  select *
  4  from emp
  5  where deptno = 10) e10, (select * from fept) d
  6  where e10.deptno = d.deptno;
where deptno = 10) e10, (select * from fept) d
                                       *
ERROR at line 5:
ORA-00942: table or view does not exist 


SQL> select e10.empno, e10.ename, e10.deptno, d.dname, d.loc
  2  from (
  3  select *
  4  from emp
  5  where deptno = 10) e10, (select * from dept) d
  6  where e10.deptno = d.deptno;

     EMPNO ENAME                    DEPTNO DNAME                          LOC                                                                                                                                                                             
---------- -------------------- ---------- ------------------------------ --------------------------                                                                                                                                                      
      7782 CLARK                        10 ACCOUNTING                     NEW YORK                                                                                                                                                                        
      7839 KING                         10 ACCOUNTING                     NEW YORK                                                                                                                                                                        
      7934 MILLER                       10 ACCOUNTING                     NEW YORK                                                                                                                                                                        

SQL> select *
  2  from emp
  3  group by job;
select *
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno, job
  2  from emp
  3  group by job;
select deptno, job
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno, job
  2  from emp
  3  group by deptno, job;

    DEPTNO JOB                                                                                                                                                                                                                                            
---------- ------------------                                                                                                                                                                                                                             
        20 CLERK                                                                                                                                                                                                                                          
        30 SALESMAN                                                                                                                                                                                                                                       
        20 MANAGER                                                                                                                                                                                                                                        
        30 CLERK                                                                                                                                                                                                                                          
        10 PRESIDENT                                                                                                                                                                                                                                      
        30 MANAGER                                                                                                                                                                                                                                        
        10 CLERK                                                                                                                                                                                                                                          
        10 MANAGER                                                                                                                                                                                                                                        
        20 ANALYST                                                                                                                                                                                                                                        

9 rows selected.

SQL> select *
  2  from emp
  3  group by deptno, job;
select *
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno, ename, job, sal
  2  from emp
  3  group by deptno, job;
select deptno, ename, job, sal
               *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno, ename, job, sal
  2  from emp
  3  group by rollup(deptno, job);
select deptno, ename, job, sal
               *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno, job
  2  from emp
  3  group by rollup(deptno, job);

    DEPTNO JOB                                                                                                                                                                                                                                            
---------- ------------------                                                                                                                                                                                                                             
        10 CLERK                                                                                                                                                                                                                                          
        10 MANAGER                                                                                                                                                                                                                                        
        10 PRESIDENT                                                                                                                                                                                                                                      
        10                                                                                                                                                                                                                                                
        20 CLERK                                                                                                                                                                                                                                          
        20 ANALYST                                                                                                                                                                                                                                        
        20 MANAGER                                                                                                                                                                                                                                        
        20                                                                                                                                                                                                                                                
        30 CLERK                                                                                                                                                                                                                                          
        30 MANAGER                                                                                                                                                                                                                                        
        30 SALESMAN                                                                                                                                                                                                                                       
        30                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                          

13 rows selected.

SQL> select deptno, job, sal
  2  from emp
  3  group by rollup(deptno, job);
select deptno, job, sal
                    *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno, job, max(sal)
  2  from emp
  3  group by rollup(deptno, job);

    DEPTNO JOB                  MAX(SAL)                                                                                                                                                                                                                  
---------- ------------------ ----------                                                                                                                                                                                                                  
        10 CLERK                    1300                                                                                                                                                                                                                  
        10 MANAGER                  2450                                                                                                                                                                                                                  
        10 PRESIDENT                5000                                                                                                                                                                                                                  
        10                          5000                                                                                                                                                                                                                  
        20 CLERK                    1100                                                                                                                                                                                                                  
        20 ANALYST                  3000                                                                                                                                                                                                                  
        20 MANAGER                  2975                                                                                                                                                                                                                  
        20                          3000                                                                                                                                                                                                                  
        30 CLERK                     950                                                                                                                                                                                                                  
        30 MANAGER                  2850                                                                                                                                                                                                                  
        30 SALESMAN                 1600                                                                                                                                                                                                                  
        30                          2850                                                                                                                                                                                                                  
                                    5000                                                                                                                                                                                                                  

13 rows selected.

SQL> select ename, job, max(sal)
  2  from emp
  3  group by rollup(ename, job);

ENAME                JOB                  MAX(SAL)                                                                                                                                                                                                        
-------------------- ------------------ ----------                                                                                                                                                                                                        
FORD                 ANALYST                  3000                                                                                                                                                                                                        
FORD                                          3000                                                                                                                                                                                                        
KING                 PRESIDENT                5000                                                                                                                                                                                                        
KING                                          5000                                                                                                                                                                                                        
WARD                 SALESMAN                 1259                                                                                                                                                                                                        
WARD                                          1259                                                                                                                                                                                                        
ADAMS                CLERK                    1100                                                                                                                                                                                                        
ADAMS                                         1100                                                                                                                                                                                                        
ALLEN                SALESMAN                 1600                                                                                                                                                                                                        
ALLEN                                         1600                                                                                                                                                                                                        
BLAKE                MANAGER                  2850                                                                                                                                                                                                        
BLAKE                                         2850                                                                                                                                                                                                        
CLARK                MANAGER                  2450                                                                                                                                                                                                        
CLARK                                         2450                                                                                                                                                                                                        
JAMES                CLERK                     950                                                                                                                                                                                                        
JAMES                                          950                                                                                                                                                                                                        
JONES                MANAGER                  2975                                                                                                                                                                                                        
JONES                                         2975                                                                                                                                                                                                        
SCOTT                ANALYST                  3000                                                                                                                                                                                                        
SCOTT                                         3000                                                                                                                                                                                                        
SMITH                CLERK                     800                                                                                                                                                                                                        
SMITH                                          800                                                                                                                                                                                                        
MARTIN               SALESMAN                 1250                                                                                                                                                                                                        
MARTIN                                        1250                                                                                                                                                                                                        
MILLER               CLERK                    1300                                                                                                                                                                                                        
MILLER                                        1300                                                                                                                                                                                                        
TURNER               SALESMAN                 1500                                                                                                                                                                                                        

ENAME                JOB                  MAX(SAL)                                                                                                                                                                                                        
-------------------- ------------------ ----------                                                                                                                                                                                                        
TURNER                                        1500                                                                                                                                                                                                        
                                              5000                                                                                                                                                                                                        

29 rows selected.

SQL> select ename, job, max(sal)
  2  from emp
  3  group by rollup(job, sal);
select ename, job, max(sal)
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select empno, ename, job, sal, (
  2  select grade
  3  from salgrade
  4  where e.sal between losal and hisal) as salgrade, deptno, (
  5  select dname from dept
  6  where e.deptno = dept.deptno) as dname
  7  from emp e;

     EMPNO ENAME                JOB                       SAL   SALGRADE     DEPTNO DNAME                                                                                                                                                                 
---------- -------------------- ------------------ ---------- ---------- ---------- ------------------------------                                                                                                                                        
      7369 SMITH                CLERK                     800          1         20 RESEARCH                                                                                                                                                              
      7499 ALLEN                SALESMAN                 1600          3         30 SALES                                                                                                                                                                 
      7521 WARD                 SALESMAN                 1259          2         30 SALES                                                                                                                                                                 
      7566 JONES                MANAGER                  2975          4         20 RESEARCH                                                                                                                                                              
      7654 MARTIN               SALESMAN                 1250          2         30 SALES                                                                                                                                                                 
      7698 BLAKE                MANAGER                  2850          4         30 SALES                                                                                                                                                                 
      7782 CLARK                MANAGER                  2450          4         10 ACCOUNTING                                                                                                                                                            
      7788 SCOTT                ANALYST                  3000          4         20 RESEARCH                                                                                                                                                              
      7839 KING                 PRESIDENT                5000                    10 ACCOUNTING                                                                                                                                                            
      7844 TURNER               SALESMAN                 1500          3         30 SALES                                                                                                                                                                 
      7876 ADAMS                CLERK                    1100          1         20 RESEARCH                                                                                                                                                              
      7900 JAMES                CLERK                     950          1         30 SALES                                                                                                                                                                 
      7902 FORD                 ANALYST                  3000          4         20 RESEARCH                                                                                                                                                              
      7934 MILLER               CLERK                    1300          2         10 ACCOUNTING                                                                                                                                                            

14 rows selected.

SQL> select empno, ename, job, sal, (
  2  select grade
  3  from salgrade
  4  where emp.sal between losal and hisal) as salgrade, deptno, (
  5  select dname from dept
  6  where emp.deptno = dept.deptno) as dname
  7  from emp e;
where emp.sal between losal and hisal) as salgrade, deptno, (
      *
ERROR at line 4:
ORA-00904: "EMP"."SAL": invalid identifier 


SQL> select empno, ename, job, sal, (
  2  select grade
  3  from salgrade
  4  where emp.sal between losal and hisal) as salgrade, deptno, (
  5  select dname from dept
  6  where e.deptno = dept.deptno) as dname
  7  from emp e;
where emp.sal between losal and hisal) as salgrade, deptno, (
      *
ERROR at line 4:
ORA-00904: "EMP"."SAL": invalid identifier 


SQL> --ex 9-21
SQL> select empno, ename, job, sal, (
  2  select grade
  3  from salgrade
  4  where e.sal between losal and hisal) as salgrade, deptno, (
  5  select dname from dept
  6  where e.deptno = dept.deptno) as dname
  7  from emp e;

     EMPNO ENAME                JOB                       SAL   SALGRADE     DEPTNO DNAME                                                                                                                                                                 
---------- -------------------- ------------------ ---------- ---------- ---------- ------------------------------                                                                                                                                        
      7369 SMITH                CLERK                     800          1         20 RESEARCH                                                                                                                                                              
      7499 ALLEN                SALESMAN                 1600          3         30 SALES                                                                                                                                                                 
      7521 WARD                 SALESMAN                 1259          2         30 SALES                                                                                                                                                                 
      7566 JONES                MANAGER                  2975          4         20 RESEARCH                                                                                                                                                              
      7654 MARTIN               SALESMAN                 1250          2         30 SALES                                                                                                                                                                 
      7698 BLAKE                MANAGER                  2850          4         30 SALES                                                                                                                                                                 
      7782 CLARK                MANAGER                  2450          4         10 ACCOUNTING                                                                                                                                                            
      7788 SCOTT                ANALYST                  3000          4         20 RESEARCH                                                                                                                                                              
      7839 KING                 PRESIDENT                5000                    10 ACCOUNTING                                                                                                                                                            
      7844 TURNER               SALESMAN                 1500          3         30 SALES                                                                                                                                                                 
      7876 ADAMS                CLERK                    1100          1         20 RESEARCH                                                                                                                                                              
      7900 JAMES                CLERK                     950          1         30 SALES                                                                                                                                                                 
      7902 FORD                 ANALYST                  3000          4         20 RESEARCH                                                                                                                                                              
      7934 MILLER               CLERK                    1300          2         10 ACCOUNTING                                                                                                                                                            

14 rows selected.

SQL> select max(sal)
  2  from emp
  3  where job in ('MANAGER', 'CLERK', 'SALESMAN','ANALYST');

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      3000                                                                                                                                                                                                                                                

SQL> select empno, ename, job, deptno,
  2   (select dname
  3   from dept
  4   where e.deptno = dept.deptno) as dname
  5  from emp e;

     EMPNO ENAME                JOB                    DEPTNO DNAME                                                                                                                                                                                       
---------- -------------------- ------------------ ---------- ------------------------------                                                                                                                                                              
      7369 SMITH                CLERK                      20 RESEARCH                                                                                                                                                                                    
      7499 ALLEN                SALESMAN                   30 SALES                                                                                                                                                                                       
      7521 WARD                 SALESMAN                   30 SALES                                                                                                                                                                                       
      7566 JONES                MANAGER                    20 RESEARCH                                                                                                                                                                                    
      7654 MARTIN               SALESMAN                   30 SALES                                                                                                                                                                                       
      7698 BLAKE                MANAGER                    30 SALES                                                                                                                                                                                       
      7782 CLARK                MANAGER                    10 ACCOUNTING                                                                                                                                                                                  
      7788 SCOTT                ANALYST                    20 RESEARCH                                                                                                                                                                                    
      7839 KING                 PRESIDENT                  10 ACCOUNTING                                                                                                                                                                                  
      7844 TURNER               SALESMAN                   30 SALES                                                                                                                                                                                       
      7876 ADAMS                CLERK                      20 RESEARCH                                                                                                                                                                                    
      7900 JAMES                CLERK                      30 SALES                                                                                                                                                                                       
      7902 FORD                 ANALYST                    20 RESEARCH                                                                                                                                                                                    
      7934 MILLER               CLERK                      10 ACCOUNTING                                                                                                                                                                                  

14 rows selected.

SQL> select empno, ename, job, deptno,
  2   (select dname
  3   from dept
  4   where e.deptno = dept.deptno) as dname, d.loc
  5  from emp e;
 where e.deptno = dept.deptno) as dname, d.loc
                                         *
ERROR at line 4:
ORA-00904: "D"."LOC": invalid identifier 


SQL> select empno, ename, job, deptno, d.dname, d.loc
  2  from (
  3  select * from emp where deptno = 10)e10 , (select * from dept) d;
select empno, ename, job, deptno, d.dname, d.loc
                          *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> select empno, ename, job, deptno, d.dname, d.loc
  2  from emp, (select * from dept) d;
select empno, ename, job, deptno, d.dname, d.loc
                          *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> select empno, ename, job, deptno, (select dname
  2   from dept
  3   where e.deptno = dept.deptno) as dname
  4  from dept, emp
  5  where deptno = deptno
  6  and deptno = 10;
and deptno = 10
    *
ERROR at line 6:
ORA-00918: column ambiguously defined 


SQL> select empno, ename, job, deptno, (select dname
  2   from dept
  3   where e.deptno = dept.deptno) as dname
  4  from dept, emp
  5  where deptno = 10;
where deptno = 10
      *
ERROR at line 5:
ORA-00918: column ambiguously defined 


SQL> select empno, ename, job, deptno, (select dname
  2   from dept
  3   where e.deptno = dept.deptno) as dname
  4  from dept, emp
  5  where deptno in 10;
where deptno in 10
      *
ERROR at line 5:
ORA-00918: column ambiguously defined 


SQL> select empno, ename, job, deptno, (select dname
  2   from dept
  3   where e.deptno = dept.deptno) as dname
  4  from dept, emp
  5  where deptno = deptno
  6  and deptno = 10
  7  and job
  8  (select
  9  from emp
 10  where deptno = 30);
(select
 *
ERROR at line 8:
ORA-00936: missing expression 


SQL> select empno, ename, job, deptno, (select dname
  2   from dept
  3   where e.deptno = dept.deptno) as dname
  4  from dept, emp
  5  where deptno = deptno
  6  and deptno = 10
  7  and job not in
  8  (select
  9  from emp
 10  where deptno = 30);
from emp
*
ERROR at line 9:
ORA-00936: missing expression 


SQL> select empno, ename, job, deptno, d.dname, d.loc
  2  from dept d, emp e
  3  where deptno = deptno
  4  and deptno = 10
  5  and job not in
  6  (select
  7  from emp
  8  where deptno = 30);
from emp
*
ERROR at line 7:
ORA-00936: missing expression 


SQL> select e.empno, e.ename, e.job, d.deptno, d.dname, d.loc
  2  from dept d, emp e
  3  where d.deptno = e.deptno
  4  and e.deptno = 10
  5  and job not in
  6  (select
  7  from emp
  8  where e.deptno = 30);
from emp
*
ERROR at line 7:
ORA-00936: missing expression 


SQL> select e.empno, e.ename, e.job, d.deptno, d.dname, d.loc
  2  from dept d, emp e
  3  where d.deptno = e.deptno
  4  and e.deptno = 10
  5  and job not in
  6  (select job
  7  from emp
  8  where e.deptno = 30);

     EMPNO ENAME                JOB                    DEPTNO DNAME                          LOC                                                                                                                                                          
---------- -------------------- ------------------ ---------- ------------------------------ --------------------------                                                                                                                                   
      7782 CLARK                MANAGER                    10 ACCOUNTING                     NEW YORK                                                                                                                                                     
      7839 KING                 PRESIDENT                  10 ACCOUNTING                     NEW YORK                                                                                                                                                     
      7934 MILLER               CLERK                      10 ACCOUNTING                     NEW YORK                                                                                                                                                     

SQL> select job
  2  from emp
  3  where deptno = 30;

JOB                                                                                                                                                                                                                                                       
------------------                                                                                                                                                                                                                                        
SALESMAN                                                                                                                                                                                                                                                  
SALESMAN                                                                                                                                                                                                                                                  
SALESMAN                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                   
SALESMAN                                                                                                                                                                                                                                                  
CLERK                                                                                                                                                                                                                                                     

6 rows selected.

SQL> select e.empno, e.ename, e.job, d.deptno, d.dname, d.loc
  2  from dept d, emp e
  3  where d.deptno = e.deptno
  4  and e.deptno = 10
  5  and job not in
  6  (select job
  7  from emp
  8  where e.deptno = 30);

     EMPNO ENAME                JOB                    DEPTNO DNAME                          LOC                                                                                                                                                          
---------- -------------------- ------------------ ---------- ------------------------------ --------------------------                                                                                                                                   
      7782 CLARK                MANAGER                    10 ACCOUNTING                     NEW YORK                                                                                                                                                     
      7839 KING                 PRESIDENT                  10 ACCOUNTING                     NEW YORK                                                                                                                                                     
      7934 MILLER               CLERK                      10 ACCOUNTING                     NEW YORK                                                                                                                                                     

SQL> select e.empno, e.ename, e.job, d.deptno, d.dname, d.loc
  2  from dept d, emp e
  3  where d.deptno = e.deptno
  4  and e.deptno = 10
  5  and job not in
  6  (select job
  7  from emp
  8  where deptno = 30);

     EMPNO ENAME                JOB                    DEPTNO DNAME                          LOC                                                                                                                                                          
---------- -------------------- ------------------ ---------- ------------------------------ --------------------------                                                                                                                                   
      7839 KING                 PRESIDENT                  10 ACCOUNTING                     NEW YORK                                                                                                                                                     

SQL> select sal
  2  from emp
  3  where job in ('MANAGER', 'CLERK', 'SALESMAN','ANALYST');

       SAL                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
       800                                                                                                                                                                                                                                                
      1600                                                                                                                                                                                                                                                
      1259                                                                                                                                                                                                                                                
      2975                                                                                                                                                                                                                                                
      1250                                                                                                                                                                                                                                                
      2850                                                                                                                                                                                                                                                
      2450                                                                                                                                                                                                                                                
      3000                                                                                                                                                                                                                                                
      1500                                                                                                                                                                                                                                                
      1100                                                                                                                                                                                                                                                
       950                                                                                                                                                                                                                                                
      3000                                                                                                                                                                                                                                                
      1300                                                                                                                                                                                                                                                

13 rows selected.

SQL> select deptno, ename, job, sal
  2  from emp
  3  where job in (
  4  select sal
  5  from emp
  6  where job in ('MANAGER', 'CLERK', 'SALESMAN','ANALYST') );
where job in (
      *
ERROR at line 3:
ORA-01722: invalid number 


SQL> select max(sal)
  2  from emp
  3  group by job;

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      1300                                                                                                                                                                                                                                                
      1600                                                                                                                                                                                                                                                
      5000                                                                                                                                                                                                                                                
      2975                                                                                                                                                                                                                                                
      3000                                                                                                                                                                                                                                                

SQL> select deptno, ename, job, sal
  2  from emp
  3  where max(sal) in (
  4  select max(sal)
  5  from emp
  6  group by job);
where max(sal) in (
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> select deptno, ename, job, max(sal)
  2  from emp
  3  where max(sal) in (
  4  select max(sal)
  5  from emp
  6  group by job);
where max(sal) in (
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> select job, max(sal)
  2  from emp
  3  group by job;

JOB                  MAX(SAL)                                                                                                                                                                                                                             
------------------ ----------                                                                                                                                                                                                                             
CLERK                    1300                                                                                                                                                                                                                             
SALESMAN                 1600                                                                                                                                                                                                                             
PRESIDENT                5000                                                                                                                                                                                                                             
MANAGER                  2975                                                                                                                                                                                                                             
ANALYST                  3000                                                                                                                                                                                                                             

SQL> select job, max(sal)
  2  from emp;
select job, max(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select deptno, ename, job, max(sal)
  2  from emp;
select deptno, ename, job, max(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select deptno, ename, job, sal
  2  from emp
  3  where sal in (
  4  select job, max(sal)
  5  from emp
  6  group by job);
select job, max(sal)
*
ERROR at line 4:
ORA-00913: too many values 


SQL> select deptno, ename, job, sal
  2  from emp;

    DEPTNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
        20 SMITH                CLERK                     800                                                                                                                                                                                             
        30 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
        30 WARD                 SALESMAN                 1259                                                                                                                                                                                             
        20 JONES                MANAGER                  2975                                                                                                                                                                                             
        30 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
        30 BLAKE                MANAGER                  2850                                                                                                                                                                                             
        10 CLARK                MANAGER                  2450                                                                                                                                                                                             
        20 SCOTT                ANALYST                  3000                                                                                                                                                                                             
        10 KING                 PRESIDENT                5000                                                                                                                                                                                             
        30 TURNER               SALESMAN                 1500                                                                                                                                                                                             
        20 ADAMS                CLERK                    1100                                                                                                                                                                                             
        30 JAMES                CLERK                     950                                                                                                                                                                                             
        20 FORD                 ANALYST                  3000                                                                                                                                                                                             
        10 MILLER               CLERK                    1300                                                                                                                                                                                             

14 rows selected.

SQL> select *
  2  from emp, dept
  3  order by empno;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO     DEPTNO DNAME                          LOC                                                                                                     
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ---------- ---------- ------------------------------ --------------------------                                                                              
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         40 OPERATIONS                     BOSTON                                                                                                  
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         30 SALES                          CHICAGO                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         20 RESEARCH                       DALLAS                                                                                                  
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         10 ACCOUNTING                     NEW YORK                                                                                                
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         30 SALES                          CHICAGO                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         10 ACCOUNTING                     NEW YORK                                                                                                
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         20 RESEARCH                       DALLAS                                                                                                  
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         40 OPERATIONS                     BOSTON                                                                                                  
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30         30 SALES                          CHICAGO                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30         10 ACCOUNTING                     NEW YORK                                                                                                
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30         40 OPERATIONS                     BOSTON                                                                                                  
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30         20 RESEARCH                       DALLAS                                                                                                  
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         10 ACCOUNTING                     NEW YORK                                                                                                
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         30 SALES                          CHICAGO                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         40 OPERATIONS                     BOSTON                                                                                                  
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         20 RESEARCH                       DALLAS                                                                                                  
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         30 SALES                          CHICAGO                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         40 OPERATIONS                     BOSTON                                                                                                  
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         20 RESEARCH                       DALLAS                                                                                                  
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         10 ACCOUNTING                     NEW YORK                                                                                                
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         20 RESEARCH                       DALLAS                                                                                                  
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         10 ACCOUNTING                     NEW YORK                                                                                                
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         40 OPERATIONS                     BOSTON                                                                                                  
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         30 SALES                          CHICAGO                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         40 OPERATIONS                     BOSTON                                                                                                  
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         20 RESEARCH                       DALLAS                                                                                                  
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         10 ACCOUNTING                     NEW YORK                                                                                                

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO     DEPTNO DNAME                          LOC                                                                                                     
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ---------- ---------- ------------------------------ --------------------------                                                                              
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         30 SALES                          CHICAGO                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         20 RESEARCH                       DALLAS                                                                                                  
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         10 ACCOUNTING                     NEW YORK                                                                                                
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         40 OPERATIONS                     BOSTON                                                                                                  
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         30 SALES                          CHICAGO                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         30 SALES                          CHICAGO                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         10 ACCOUNTING                     NEW YORK                                                                                                
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         20 RESEARCH                       DALLAS                                                                                                  
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         40 OPERATIONS                     BOSTON                                                                                                  
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         10 ACCOUNTING                     NEW YORK                                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         30 SALES                          CHICAGO                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         20 RESEARCH                       DALLAS                                                                                                  
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         40 OPERATIONS                     BOSTON                                                                                                  
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         20 RESEARCH                       DALLAS                                                                                                  
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         40 OPERATIONS                     BOSTON                                                                                                  
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         30 SALES                          CHICAGO                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         10 ACCOUNTING                     NEW YORK                                                                                                
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         20 RESEARCH                       DALLAS                                                                                                  
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         10 ACCOUNTING                     NEW YORK                                                                                                
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         40 OPERATIONS                     BOSTON                                                                                                  
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         30 SALES                          CHICAGO                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         30 SALES                          CHICAGO                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         20 RESEARCH                       DALLAS                                                                                                  
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         10 ACCOUNTING                     NEW YORK                                                                                                
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         40 OPERATIONS                     BOSTON                                                                                                  
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         20 RESEARCH                       DALLAS                                                                                                  
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         10 ACCOUNTING                     NEW YORK                                                                                                

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO     DEPTNO DNAME                          LOC                                                                                                     
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ---------- ---------- ------------------------------ --------------------------                                                                              
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         40 OPERATIONS                     BOSTON                                                                                                  
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         30 SALES                          CHICAGO                                                                                                 

56 rows selected.

SQL> select *
  2  from emp, dept
  3  where emp.deptno = dept.deptno
  4  order by empno;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO     DEPTNO DNAME                          LOC                                                                                                     
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ---------- ---------- ------------------------------ --------------------------                                                                              
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         20 RESEARCH                       DALLAS                                                                                                  
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         30 SALES                          CHICAGO                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30         30 SALES                          CHICAGO                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         20 RESEARCH                       DALLAS                                                                                                  
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         30 SALES                          CHICAGO                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         30 SALES                          CHICAGO                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         10 ACCOUNTING                     NEW YORK                                                                                                
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         20 RESEARCH                       DALLAS                                                                                                  
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         10 ACCOUNTING                     NEW YORK                                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         30 SALES                          CHICAGO                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         20 RESEARCH                       DALLAS                                                                                                  
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         30 SALES                          CHICAGO                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         20 RESEARCH                       DALLAS                                                                                                  
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         10 ACCOUNTING                     NEW YORK                                                                                                

14 rows selected.

SQL> select deptno, ename, job, (select max(sal)
  2  from emp
  3  group by job)
  4  from emp;
select deptno, ename, job, (select max(sal)
                            *
ERROR at line 1:
ORA-01427: single-row subquery returns more than one row 


SQL> select deptno, ename, job, (select job, max(sal)
  2  from emp
  3  group by job)
  4  from emp;
select deptno, ename, job, (select job, max(sal)
                            *
ERROR at line 1:
ORA-00913: too many values 


SQL> select deptno, ename, (select job, max(sal)
  2  from emp
  3  group by job)
  4  from emp;
select deptno, ename, (select job, max(sal)
                       *
ERROR at line 1:
ORA-00913: too many values 


SQL> select deptno, ename, job, sal
  2  from emp;

    DEPTNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
        20 SMITH                CLERK                     800                                                                                                                                                                                             
        30 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
        30 WARD                 SALESMAN                 1259                                                                                                                                                                                             
        20 JONES                MANAGER                  2975                                                                                                                                                                                             
        30 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
        30 BLAKE                MANAGER                  2850                                                                                                                                                                                             
        10 CLARK                MANAGER                  2450                                                                                                                                                                                             
        20 SCOTT                ANALYST                  3000                                                                                                                                                                                             
        10 KING                 PRESIDENT                5000                                                                                                                                                                                             
        30 TURNER               SALESMAN                 1500                                                                                                                                                                                             
        20 ADAMS                CLERK                    1100                                                                                                                                                                                             
        30 JAMES                CLERK                     950                                                                                                                                                                                             
        20 FORD                 ANALYST                  3000                                                                                                                                                                                             
        10 MILLER               CLERK                    1300                                                                                                                                                                                             

14 rows selected.

SQL> select max(sal)
  2  from emp
  3  group by job;

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      1300                                                                                                                                                                                                                                                
      1600                                                                                                                                                                                                                                                
      5000                                                                                                                                                                                                                                                
      2975                                                                                                                                                                                                                                                
      3000                                                                                                                                                                                                                                                

SQL> select *
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  order by empno;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO     DEPTNO DNAME                          LOC                                                                                                     
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ---------- ---------- ------------------------------ --------------------------                                                                              
      7369 SMITH                CLERK                    7902 80/12/17        800                    20         20 RESEARCH                       DALLAS                                                                                                  
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30         30 SALES                          CHICAGO                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30         30 SALES                          CHICAGO                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20         20 RESEARCH                       DALLAS                                                                                                  
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30         30 SALES                          CHICAGO                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30         30 SALES                          CHICAGO                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10         10 ACCOUNTING                     NEW YORK                                                                                                
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20         20 RESEARCH                       DALLAS                                                                                                  
      7839 KING                 PRESIDENT                     81/11/17       5000                    10         10 ACCOUNTING                     NEW YORK                                                                                                
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30         30 SALES                          CHICAGO                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20         20 RESEARCH                       DALLAS                                                                                                  
      7900 JAMES                CLERK                    7698 81/12/03        950                    30         30 SALES                          CHICAGO                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20         20 RESEARCH                       DALLAS                                                                                                  
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10         10 ACCOUNTING                     NEW YORK                                                                                                

14 rows selected.

SQL> select emp.ename, emp.deptno, dept.dname
  2  from emp, dept
  3  where emp.deptno = dept.deptno
  4  and emp.deptno = (
  5  select deptno
  6  from emp
  7  where ename = 'SCOTT');

ENAME                    DEPTNO DNAME                                                                                                                                                                                                                     
-------------------- ---------- ------------------------------                                                                                                                                                                                            
SMITH                        20 RESEARCH                                                                                                                                                                                                                  
JONES                        20 RESEARCH                                                                                                                                                                                                                  
SCOTT                        20 RESEARCH                                                                                                                                                                                                                  
ADAMS                        20 RESEARCH                                                                                                                                                                                                                  
FORD                         20 RESEARCH                                                                                                                                                                                                                  

SQL> select deptno, ename, job, sal
  2  from emp
  3  where sal = (
  4  select max(sal)
  5  from emp
  6  group by job);
select max(sal)
*
ERROR at line 4:
ORA-01427: single-row subquery returns more than one row 


SQL> select max(sal)
  2  from emp
  3  group by job;

  MAX(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      1300                                                                                                                                                                                                                                                
      1600                                                                                                                                                                                                                                                
      5000                                                                                                                                                                                                                                                
      2975                                                                                                                                                                                                                                                
      3000                                                                                                                                                                                                                                                

SQL> select deptno, ename, job, sal
  2  from emp
  3  where sal = (
  4  select job, max(sal)
  5  from emp
  6  group by job);
select job, max(sal)
*
ERROR at line 4:
ORA-00913: too many values 


SQL> select *
  2  from dept
  3  ;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> select d.dname
  2  from emp e, dept d
  3  where ename = 'ALLEN';

DNAME                                                                                                                                                                                                                                                     
------------------------------                                                                                                                                                                                                                            
ACCOUNTING                                                                                                                                                                                                                                                
RESEARCH                                                                                                                                                                                                                                                  
SALES                                                                                                                                                                                                                                                     
OPERATIONS                                                                                                                                                                                                                                                

SQL> select d.dname
  2  from emp e, dept d
  3  where ename = 'ALLEN' and
  4  e.deptno = d.deptno ;

DNAME                                                                                                                                                                                                                                                     
------------------------------                                                                                                                                                                                                                            
SALES                                                                                                                                                                                                                                                     

SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> select empno, ename, job, sal
  2  from emp
  3  where sal < all(
  4  select sal
  5  from emp
  6  where job = 'ANALYST');

     EMPNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
      7566 JONES                MANAGER                  2975                                                                                                                                                                                             
      7698 BLAKE                MANAGER                  2850                                                                                                                                                                                             
      7782 CLARK                MANAGER                  2450                                                                                                                                                                                             
      7499 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
      7844 TURNER               SALESMAN                 1500                                                                                                                                                                                             
      7934 MILLER               CLERK                    1300                                                                                                                                                                                             
      7521 WARD                 SALESMAN                 1259                                                                                                                                                                                             
      7654 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
      7876 ADAMS                CLERK                    1100                                                                                                                                                                                             
      7900 JAMES                CLERK                     950                                                                                                                                                                                             
      7369 SMITH                CLERK                     800                                                                                                                                                                                             

11 rows selected.

SQL> select *
  2  from dept;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno;

ENAME                    DEPTNO        SAL JOB                                                                                                                                                                                                            
-------------------- ---------- ---------- ------------------                                                                                                                                                                                             
SMITH                        20        800 CLERK                                                                                                                                                                                                          
ALLEN                        30       1600 SALESMAN                                                                                                                                                                                                       
WARD                         30       1259 SALESMAN                                                                                                                                                                                                       
JONES                        20       2975 MANAGER                                                                                                                                                                                                        
MARTIN                       30       1250 SALESMAN                                                                                                                                                                                                       
BLAKE                        30       2850 MANAGER                                                                                                                                                                                                        
CLARK                        10       2450 MANAGER                                                                                                                                                                                                        
SCOTT                        20       3000 ANALYST                                                                                                                                                                                                        
KING                         10       5000 PRESIDENT                                                                                                                                                                                                      
TURNER                       30       1500 SALESMAN                                                                                                                                                                                                       
ADAMS                        20       1100 CLERK                                                                                                                                                                                                          
JAMES                        30        950 CLERK                                                                                                                                                                                                          
FORD                         20       3000 ANALYST                                                                                                                                                                                                        
MILLER                       10       1300 CLERK                                                                                                                                                                                                          

14 rows selected.

SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno and e.sal between dname = 'SALES' and avg(sal) and
  4  dname = 'RESEARCH' and avg(sal);
where e.deptno = d.deptno and e.sal between dname = 'SALES' and avg(sal) and
                                                  *
ERROR at line 3:
ORA-00905: missing keyword 


SQL> select empno, ename, job, sal
  2  from emp
  3  where sal < all(
  4  select sal
  5  from emp
  6  where job = 'ANALYST');

     EMPNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
      7566 JONES                MANAGER                  2975                                                                                                                                                                                             
      7698 BLAKE                MANAGER                  2850                                                                                                                                                                                             
      7782 CLARK                MANAGER                  2450                                                                                                                                                                                             
      7499 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
      7844 TURNER               SALESMAN                 1500                                                                                                                                                                                             
      7934 MILLER               CLERK                    1300                                                                                                                                                                                             
      7521 WARD                 SALESMAN                 1259                                                                                                                                                                                             
      7654 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
      7876 ADAMS                CLERK                    1100                                                                                                                                                                                             
      7900 JAMES                CLERK                     950                                                                                                                                                                                             
      7369 SMITH                CLERK                     800                                                                                                                                                                                             

11 rows selected.

SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and e.sal > avg(dname = 'SALES');
and e.sal > avg(dname = 'SALES')
            *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and e.sal > avg(sal and dname = 'SALES');
and e.sal > avg(sal and dname = 'SALES')
            *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> 
SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and e.sal > avg(e.sal and d.dname = 'SALES');
and e.sal > avg(e.sal and d.dname = 'SALES')
            *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> select empno, ename, job, sal
  2  from emp
  3  where sal < all(
  4  select sal
  5  from emp
  6  where job = 'ANALYST');

     EMPNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
      7566 JONES                MANAGER                  2975                                                                                                                                                                                             
      7698 BLAKE                MANAGER                  2850                                                                                                                                                                                             
      7782 CLARK                MANAGER                  2450                                                                                                                                                                                             
      7499 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
      7844 TURNER               SALESMAN                 1500                                                                                                                                                                                             
      7934 MILLER               CLERK                    1300                                                                                                                                                                                             
      7521 WARD                 SALESMAN                 1259                                                                                                                                                                                             
      7654 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
      7876 ADAMS                CLERK                    1100                                                                                                                                                                                             
      7900 JAMES                CLERK                     950                                                                                                                                                                                             
      7369 SMITH                CLERK                     800                                                                                                                                                                                             

11 rows selected.

SQL> select empno, ename, job, sal
  2  from emp
  3  where not job = 'ANALYST' and sal < all(
  4  select sal
  5  from emp
  6  where job = 'ANALYST');

     EMPNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
      7566 JONES                MANAGER                  2975                                                                                                                                                                                             
      7698 BLAKE                MANAGER                  2850                                                                                                                                                                                             
      7782 CLARK                MANAGER                  2450                                                                                                                                                                                             
      7499 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
      7844 TURNER               SALESMAN                 1500                                                                                                                                                                                             
      7934 MILLER               CLERK                    1300                                                                                                                                                                                             
      7521 WARD                 SALESMAN                 1259                                                                                                                                                                                             
      7654 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
      7876 ADAMS                CLERK                    1100                                                                                                                                                                                             
      7900 JAMES                CLERK                     950                                                                                                                                                                                             
      7369 SMITH                CLERK                     800                                                                                                                                                                                             

11 rows selected.

SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and e.sal > avg(sal) and (dname = 'SALES');
and e.sal > avg(sal) and (dname = 'SALES')
            *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and avg(e.sal) and d.dname = 'SALES';
and avg(e.sal) and d.dname = 'SALES'
    *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and avg(sal) and d.dname = 'SALES';
and avg(sal) and d.dname = 'SALES'
    *
ERROR at line 4:
ORA-00934: group function is not allowed here 


SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno;

ENAME                    DEPTNO        SAL JOB                                                                                                                                                                                                            
-------------------- ---------- ---------- ------------------                                                                                                                                                                                             
SMITH                        20        800 CLERK                                                                                                                                                                                                          
ALLEN                        30       1600 SALESMAN                                                                                                                                                                                                       
WARD                         30       1259 SALESMAN                                                                                                                                                                                                       
JONES                        20       2975 MANAGER                                                                                                                                                                                                        
MARTIN                       30       1250 SALESMAN                                                                                                                                                                                                       
BLAKE                        30       2850 MANAGER                                                                                                                                                                                                        
CLARK                        10       2450 MANAGER                                                                                                                                                                                                        
SCOTT                        20       3000 ANALYST                                                                                                                                                                                                        
KING                         10       5000 PRESIDENT                                                                                                                                                                                                      
TURNER                       30       1500 SALESMAN                                                                                                                                                                                                       
ADAMS                        20       1100 CLERK                                                                                                                                                                                                          
JAMES                        30        950 CLERK                                                                                                                                                                                                          
FORD                         20       3000 ANALYST                                                                                                                                                                                                        
MILLER                       10       1300 CLERK                                                                                                                                                                                                          

14 rows selected.

SQL> select empno, ename, job, sal
  2  from emp
  3  where job not in ('ANALYST') and sal < all(
  4  select sal
  5  from emp
  6  where job = 'ANALYST');

     EMPNO ENAME                JOB                       SAL                                                                                                                                                                                             
---------- -------------------- ------------------ ----------                                                                                                                                                                                             
      7566 JONES                MANAGER                  2975                                                                                                                                                                                             
      7698 BLAKE                MANAGER                  2850                                                                                                                                                                                             
      7782 CLARK                MANAGER                  2450                                                                                                                                                                                             
      7499 ALLEN                SALESMAN                 1600                                                                                                                                                                                             
      7844 TURNER               SALESMAN                 1500                                                                                                                                                                                             
      7934 MILLER               CLERK                    1300                                                                                                                                                                                             
      7521 WARD                 SALESMAN                 1259                                                                                                                                                                                             
      7654 MARTIN               SALESMAN                 1250                                                                                                                                                                                             
      7876 ADAMS                CLERK                    1100                                                                                                                                                                                             
      7900 JAMES                CLERK                     950                                                                                                                                                                                             
      7369 SMITH                CLERK                     800                                                                                                                                                                                             

11 rows selected.

SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno;

ENAME                    DEPTNO        SAL JOB                                                                                                                                                                                                            
-------------------- ---------- ---------- ------------------                                                                                                                                                                                             
SMITH                        20        800 CLERK                                                                                                                                                                                                          
ALLEN                        30       1600 SALESMAN                                                                                                                                                                                                       
WARD                         30       1259 SALESMAN                                                                                                                                                                                                       
JONES                        20       2975 MANAGER                                                                                                                                                                                                        
MARTIN                       30       1250 SALESMAN                                                                                                                                                                                                       
BLAKE                        30       2850 MANAGER                                                                                                                                                                                                        
CLARK                        10       2450 MANAGER                                                                                                                                                                                                        
SCOTT                        20       3000 ANALYST                                                                                                                                                                                                        
KING                         10       5000 PRESIDENT                                                                                                                                                                                                      
TURNER                       30       1500 SALESMAN                                                                                                                                                                                                       
ADAMS                        20       1100 CLERK                                                                                                                                                                                                          
JAMES                        30        950 CLERK                                                                                                                                                                                                          
FORD                         20       3000 ANALYST                                                                                                                                                                                                        
MILLER                       10       1300 CLERK                                                                                                                                                                                                          

14 rows selected.

SQL> select avg(sal)
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and d.dname = 'SALES';

  AVG(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
1568.16667                                                                                                                                                                                                                                                

SQL> select avg(sal)
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and d.dname = 'RESEARCH';

  AVG(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      2175                                                                                                                                                                                                                                                

SQL> select e.ename, d.deptno, e.sal, e.job
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4   and sal > (select avg(sal)
  5  from emp e, dept d
  6  where e.deptno = d.deptno
  7  and d.dname = 'SALES')
  8   and sal < (select avg(sal)
  9  from emp e, dept d
 10  where e.deptno = d.deptno
 11  and d.dname = 'RESEARCH');

ENAME                    DEPTNO        SAL JOB                                                                                                                                                                                                            
-------------------- ---------- ---------- ------------------                                                                                                                                                                                             
ALLEN                        30       1600 SALESMAN                                                                                                                                                                                                       

SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> select *
  2  from dept;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> select dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  ename = 'FORD';
ename = 'FORD'
*
ERROR at line 4:
ORA-00933: SQL command not properly ended 


SQL> select d.dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  e.ename = 'FORD';
e.ename = 'FORD'
*
ERROR at line 4:
ORA-00933: SQL command not properly ended 


SQL> select d.dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  ename = 'FORD';
ename = 'FORD'
*
ERROR at line 4:
ORA-00933: SQL command not properly ended 


SQL> select d.dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and ename = 'FORD';

DNAME                                                                                                                                                                                                                                                     
------------------------------                                                                                                                                                                                                                            
RESEARCH                                                                                                                                                                                                                                                  

SQL> 
SQL> select dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and ename = 'FORD';

DNAME                                                                                                                                                                                                                                                     
------------------------------                                                                                                                                                                                                                            
RESEARCH                                                                                                                                                                                                                                                  

SQL> select ename, deptno, job, sal
  2  from emp;

ENAME                    DEPTNO JOB                       SAL                                                                                                                                                                                             
-------------------- ---------- ------------------ ----------                                                                                                                                                                                             
SMITH                        20 CLERK                     800                                                                                                                                                                                             
ALLEN                        30 SALESMAN                 1600                                                                                                                                                                                             
WARD                         30 SALESMAN                 1259                                                                                                                                                                                             
JONES                        20 MANAGER                  2975                                                                                                                                                                                             
MARTIN                       30 SALESMAN                 1250                                                                                                                                                                                             
BLAKE                        30 MANAGER                  2850                                                                                                                                                                                             
CLARK                        10 MANAGER                  2450                                                                                                                                                                                             
SCOTT                        20 ANALYST                  3000                                                                                                                                                                                             
KING                         10 PRESIDENT                5000                                                                                                                                                                                             
TURNER                       30 SALESMAN                 1500                                                                                                                                                                                             
ADAMS                        20 CLERK                    1100                                                                                                                                                                                             
JAMES                        30 CLERK                     950                                                                                                                                                                                             
FORD                         20 ANALYST                  3000                                                                                                                                                                                             
MILLER                       10 CLERK                    1300                                                                                                                                                                                             

14 rows selected.

SQL> where dname in (
SP2-0734: unknown command beginning "where dnam..." - rest of line ignored.
SQL> select dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and ename = 'FORD';

DNAME                                                                                                                                                                                                                                                     
------------------------------                                                                                                                                                                                                                            
RESEARCH                                                                                                                                                                                                                                                  

SQL> select ename, deptno, job, sal
  2  from emp;

ENAME                    DEPTNO JOB                       SAL                                                                                                                                                                                             
-------------------- ---------- ------------------ ----------                                                                                                                                                                                             
SMITH                        20 CLERK                     800                                                                                                                                                                                             
ALLEN                        30 SALESMAN                 1600                                                                                                                                                                                             
WARD                         30 SALESMAN                 1259                                                                                                                                                                                             
JONES                        20 MANAGER                  2975                                                                                                                                                                                             
MARTIN                       30 SALESMAN                 1250                                                                                                                                                                                             
BLAKE                        30 MANAGER                  2850                                                                                                                                                                                             
CLARK                        10 MANAGER                  2450                                                                                                                                                                                             
SCOTT                        20 ANALYST                  3000                                                                                                                                                                                             
KING                         10 PRESIDENT                5000                                                                                                                                                                                             
TURNER                       30 SALESMAN                 1500                                                                                                                                                                                             
ADAMS                        20 CLERK                    1100                                                                                                                                                                                             
JAMES                        30 CLERK                     950                                                                                                                                                                                             
FORD                         20 ANALYST                  3000                                                                                                                                                                                             
MILLER                       10 CLERK                    1300                                                                                                                                                                                             

14 rows selected.

SQL> where dname in (
SP2-0734: unknown command beginning "where dnam..." - rest of line ignored.
SQL> select dname
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and ename = 'FORD');
and ename = 'FORD')
                  *
ERROR at line 4:
ORA-00933: SQL command not properly ended 


SQL> 
SQL> select ename, deptno, job, sal
  2  from emp
  3  where dname in (
  4  select dname
  5  from emp e, dept d
  6  where e.deptno = d.deptno
  7  and ename = 'FORD');
where dname in (
      *
ERROR at line 3:
ORA-00904: "DNAME": invalid identifier 


SQL> select ename, deptno, job, sal
  2  from emp e, dept d
  3  where d.dname in (
  4  select dname
  5  from emp e, dept d
  6  where e.deptno = d.deptno
  7  and ename = 'FORD');
select ename, deptno, job, sal
              *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> select e.ename, e.deptno, e.job, e.sal
  2  from emp e, dept d
  3  where d.dname in (
  4  select dname
  5  from emp e, dept d
  6  where e.deptno = d.deptno
  7  and ename = 'FORD');

ENAME                    DEPTNO JOB                       SAL                                                                                                                                                                                             
-------------------- ---------- ------------------ ----------                                                                                                                                                                                             
SMITH                        20 CLERK                     800                                                                                                                                                                                             
ALLEN                        30 SALESMAN                 1600                                                                                                                                                                                             
WARD                         30 SALESMAN                 1259                                                                                                                                                                                             
JONES                        20 MANAGER                  2975                                                                                                                                                                                             
MARTIN                       30 SALESMAN                 1250                                                                                                                                                                                             
BLAKE                        30 MANAGER                  2850                                                                                                                                                                                             
CLARK                        10 MANAGER                  2450                                                                                                                                                                                             
SCOTT                        20 ANALYST                  3000                                                                                                                                                                                             
KING                         10 PRESIDENT                5000                                                                                                                                                                                             
TURNER                       30 SALESMAN                 1500                                                                                                                                                                                             
ADAMS                        20 CLERK                    1100                                                                                                                                                                                             
JAMES                        30 CLERK                     950                                                                                                                                                                                             
FORD                         20 ANALYST                  3000                                                                                                                                                                                             
MILLER                       10 CLERK                    1300                                                                                                                                                                                             

14 rows selected.

SQL> 
SQL> select e.ename, d.deptno, e.job, e.sal
  2  from emp e, dept d
  3  where d.dname in (
  4  select dname
  5  from emp e, dept d
  6  where e.deptno = d.deptno
  7  and ename = 'FORD');

ENAME                    DEPTNO JOB                       SAL                                                                                                                                                                                             
-------------------- ---------- ------------------ ----------                                                                                                                                                                                             
SMITH                        20 CLERK                     800                                                                                                                                                                                             
ALLEN                        20 SALESMAN                 1600                                                                                                                                                                                             
WARD                         20 SALESMAN                 1259                                                                                                                                                                                             
JONES                        20 MANAGER                  2975                                                                                                                                                                                             
MARTIN                       20 SALESMAN                 1250                                                                                                                                                                                             
BLAKE                        20 MANAGER                  2850                                                                                                                                                                                             
CLARK                        20 MANAGER                  2450                                                                                                                                                                                             
SCOTT                        20 ANALYST                  3000                                                                                                                                                                                             
KING                         20 PRESIDENT                5000                                                                                                                                                                                             
TURNER                       20 SALESMAN                 1500                                                                                                                                                                                             
ADAMS                        20 CLERK                    1100                                                                                                                                                                                             
JAMES                        20 CLERK                     950                                                                                                                                                                                             
FORD                         20 ANALYST                  3000                                                                                                                                                                                             
MILLER                       20 CLERK                    1300                                                                                                                                                                                             

14 rows selected.

SQL> select e.ename, e.deptno, e.job, e.sal
  2  from emp e, dept d
  3  where e.deptno = d.deptno
  4  and d.dname in (
  5  select dname
  6  from emp e, dept d
  7  where e.deptno = d.deptno
  8  and ename = 'FORD');

ENAME                    DEPTNO JOB                       SAL                                                                                                                                                                                             
-------------------- ---------- ------------------ ----------                                                                                                                                                                                             
SCOTT                        20 ANALYST                  3000                                                                                                                                                                                             
SMITH                        20 CLERK                     800                                                                                                                                                                                             
ADAMS                        20 CLERK                    1100                                                                                                                                                                                             
FORD                         20 ANALYST                  3000                                                                                                                                                                                             
JONES                        20 MANAGER                  2975                                                                                                                                                                                             

SQL> select d.deptno, d.dname, d.loc, count(e.ename) from dept d, emp e
  2  where e.deptno(+) = d.deptno
  3  group by d.deptno, d.dname, d.loc;

    DEPTNO DNAME                          LOC                        COUNT(E.ENAME)                                                                                                                                                                       
---------- ------------------------------ -------------------------- --------------                                                                                                                                                                       
        20 RESEARCH                       DALLAS                                  5                                                                                                                                                                       
        40 OPERATIONS                     BOSTON                                  0                                                                                                                                                                       
        10 ACCOUNTING                     NEW YORK                                3                                                                                                                                                                       
        30 SALES                          CHICAGO                                 6                                                                                                                                                                       

SQL> select deptno, dname, loc, count(*)
  2  from emp e, right outer join dept d
  3  on e.deptno = d.deptno
  4  group by deptno;
from emp e, right outer join dept d
            *
ERROR at line 2:
ORA-00942: table or view does not exist 


SQL> select deptno, dname, loc, count(*)
  2  from emp e, right outer join dept d
  3  on e.deptno = d.deptno
  4  group by deptno, dname, loc;
from emp e, right outer join dept d
            *
ERROR at line 2:
ORA-00942: table or view does not exist 


SQL> select d.deptno, d.dname, d.loc, count(*)
  2  from emp e, right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno, d.dname, d.loc;
from emp e, right outer join dept d
            *
ERROR at line 2:
ORA-00942: table or view does not exist 


SQL> select d.deptno, d.dname, d.loc, count(*)
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno, d.dname, d.loc;

    DEPTNO DNAME                          LOC                          COUNT(*)                                                                                                                                                                           
---------- ------------------------------ -------------------------- ----------                                                                                                                                                                           
        20 RESEARCH                       DALLAS                              5                                                                                                                                                                           
        40 OPERATIONS                     BOSTON                              1                                                                                                                                                                           
        10 ACCOUNTING                     NEW YORK                            3                                                                                                                                                                           
        30 SALES                          CHICAGO                             6                                                                                                                                                                           

SQL> select d.deptno, d.dname, d.loc, count(e.ename)
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno, d.dname, d.loc;

    DEPTNO DNAME                          LOC                        COUNT(E.ENAME)                                                                                                                                                                       
---------- ------------------------------ -------------------------- --------------                                                                                                                                                                       
        20 RESEARCH                       DALLAS                                  5                                                                                                                                                                       
        40 OPERATIONS                     BOSTON                                  0                                                                                                                                                                       
        10 ACCOUNTING                     NEW YORK                                3                                                                                                                                                                       
        30 SALES                          CHICAGO                                 6                                                                                                                                                                       

SQL> select d.deptno, d.dname, d.loc, count(e.ename)
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno, d.dname, d.loc;

    DEPTNO DNAME                          LOC                        COUNT(E.ENAME)                                                                                                                                                                       
---------- ------------------------------ -------------------------- --------------                                                                                                                                                                       
        20 RESEARCH                       DALLAS                                  5                                                                                                                                                                       
        40 OPERATIONS                     BOSTON                                  0                                                                                                                                                                       
        10 ACCOUNTING                     NEW YORK                                3                                                                                                                                                                       
        30 SALES                          CHICAGO                                 6                                                                                                                                                                       

SQL> order by d.deptno;
SP2-0734: unknown command beginning "order by d..." - rest of line ignored.
SQL> select d.deptno, d.dname, d.loc, count(e.ename)
  2  from emp e right outer join dept d
  3  on e.deptno = d.deptno
  4  group by d.deptno, d.dname, d.loc
  5  order by d.deptno;

    DEPTNO DNAME                          LOC                        COUNT(E.ENAME)                                                                                                                                                                       
---------- ------------------------------ -------------------------- --------------                                                                                                                                                                       
        10 ACCOUNTING                     NEW YORK                                3                                                                                                                                                                       
        20 RESEARCH                       DALLAS                                  5                                                                                                                                                                       
        30 SALES                          CHICAGO                                 6                                                                                                                                                                       
        40 OPERATIONS                     BOSTON                                  0                                                                                                                                                                       

SQL> select d.deptno, d.dname, d.loc, count(e.ename)
  2  from dept d, emp e
  3  where e.deptno(+) = d.deptno
  4  group by d.deptno, d.dname, d.loc
  5  order by d.deptno;

    DEPTNO DNAME                          LOC                        COUNT(E.ENAME)                                                                                                                                                                       
---------- ------------------------------ -------------------------- --------------                                                                                                                                                                       
        10 ACCOUNTING                     NEW YORK                                3                                                                                                                                                                       
        20 RESEARCH                       DALLAS                                  5                                                                                                                                                                       
        30 SALES                          CHICAGO                                 6                                                                                                                                                                       
        40 OPERATIONS                     BOSTON                                  0                                                                                                                                                                       

SQL> select avg(sal)
  2  from emp;

  AVG(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
2073.85714                                                                                                                                                                                                                                                

SQL> select empno, ename, dname, hiredate, loc, sal
  2  from emp, dept
  3  where emp.deptno = dept.deptno
  4  and sal > (
  5  select avg(sal)
  6  from emp);

     EMPNO ENAME                DNAME                          HIREDATE LOC                               SAL                                                                                                                                             
---------- -------------------- ------------------------------ -------- -------------------------- ----------                                                                                                                                             
      7566 JONES                RESEARCH                       81/04/02 DALLAS                           2975                                                                                                                                             
      7698 BLAKE                SALES                          81/05/01 CHICAGO                          2850                                                                                                                                             
      7782 CLARK                ACCOUNTING                     81/06/09 NEW YORK                         2450                                                                                                                                             
      7788 SCOTT                RESEARCH                       87/04/19 DALLAS                           3000                                                                                                                                             
      7839 KING                 ACCOUNTING                     81/11/17 NEW YORK                         5000                                                                                                                                             
      7902 FORD                 RESEARCH                       81/12/03 DALLAS                           3000                                                                                                                                             

6 rows selected.

SQL> 
SQL> create table dept_temp
  2   as select * from dept;

Table created.

SQL> drop table dept;
drop table dept
           *
ERROR at line 1:
ORA-02449: unique/primary keys in table referenced by foreign keys 


SQL> insert into dept_temp(deptno, dname, loc)
  2  values(10, 'database', 'seoul');

1 row created.

SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          
        10 database                       seoul                                                                                                                                                                                                           

SQL> undo
SP2-0042: unknown command "undo" - rest of line ignored.
SQL> rollback;

Rollback complete.

SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> rollback;

Rollback complete.

SQL> insert into dept_temp(deptno, dname, loc)
  2  values(50, 'DATABASE', 'SEOUL');

1 row created.

SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          
        50 DATABASE                       SEOUL                                                                                                                                                                                                           

SQL> insert into dept_temp (deptno, dname, loc)
  2  values(70, 'WEB', NULL);

1 row created.

SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          
        50 DATABASE                       SEOUL                                                                                                                                                                                                           
        70 WEB                                                                                                                                                                                                                                            

6 rows selected.

SQL> insert into dept_temp(deptno, dname, loc)
  2  values(80, 'MOBILE', '');

1 row created.

SQL> insert into dept_temp(deptno,dname,loc)
  2  values(90, 'INCHEON');
values(90, 'INCHEON')
*
ERROR at line 2:
ORA-00947: not enough values 


SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          
        50 DATABASE                       SEOUL                                                                                                                                                                                                           
        70 WEB                                                                                                                                                                                                                                            
        80 MOBILE                                                                                                                                                                                                                                         

7 rows selected.

SQL> insert into dept_temp(deptno,loc)
  2  values(90, 'INCHEON');

1 row created.

SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          
        50 DATABASE                       SEOUL                                                                                                                                                                                                           
        70 WEB                                                                                                                                                                                                                                            
        80 MOBILE                                                                                                                                                                                                                                         
        90                                INCHEON                                                                                                                                                                                                         

8 rows selected.

SQL> create table emp_temp
  2  as select *
  3  from emp
  4  where 1<> 1;

Table created.

SQL> select *
  2  from emp_temp;

no rows selected

SQL> create table emp_temp
  2  as select *
  3  from emp
  4  where 1 <> 1;
create table emp_temp
             *
ERROR at line 1:
ORA-00955: name is already used by an existing object 


SQL> drop table emp_temp;

Table dropped.

SQL> create table emp_temp
  2  as select *
  3  from emp
  4  where 1 <> 1;

Table created.

SQL> select *
  2  from emp_temp;

no rows selected

SQL> insert into emp_temp(empno, ename, job, mgr, hiredate, sal, comm, deptno)
  2  values(2111, '', 'MANAGER', 9999, TO_DATE('07/01/2001', 'DD/MM/YYYY'), 4000, NULL, 20);

1 row created.

SQL> select *
  2  from emp_temp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      2111                MANAGER                  9999 01/01/07       4000                    20                                                                                                                                                   

SQL> insert into emp_temp
  2  values(3111, '', 'MANAGER', 9999, SYSDATE, 4000, NULL, 30);

1 row created.

SQL> SELECT *
  2  FROM EMP_TEMP;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      2111                MANAGER                  9999 01/01/07       4000                    20                                                                                                                                                   
      3111                MANAGER                  9999 22/02/04       4000                    30                                                                                                                                                   

SQL> insert into emp_temp (empno, ename, job, mgr, hiredate, sal, comm, deptno)
  2  select e.empno, e.ename, e.job, e.mgr, e.hiredate, e.sal, e.comm, e.deptno
  3  from emp e, salgrade s
  4  where e.sal between s.losal and s.hisal
  5  and s.grade = 1;

3 rows created.

SQL> select *
  2  from emp_temp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      2111                MANAGER                  9999 01/01/07       4000                    20                                                                                                                                                   
      3111                MANAGER                  9999 22/02/04       4000                    30                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   

SQL> create table dept_temp2
  2  as select *
  3  from dept;

Table created.

SQL> 
SQL> desc dept_temp2;
 Name                                                                                                                                            Null?    Type
 ----------------------------------------------------------------------------------------------------------------------------------------------- -------- ------------------------------------------------------------------------------------------------
 DEPTNO                                                                                                                                                   NUMBER(2)
 DNAME                                                                                                                                                    VARCHAR2(15)
 LOC                                                                                                                                                      VARCHAR2(13)

SQL> select *
  2  from dept_temp2;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> update dept_temp2
  2  set dname = 'DATABASE',
  3  loc = 'SEOUL'
  4  where deptno = 40;

1 row updated.

SQL> select *
  2  from dept_temp2;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 DATABASE                       SEOUL                                                                                                                                                                                                           

SQL> update dept_temp2
  2  set(dname, loc) = (select dname, loc from dept where deptno = 40)
  3  where deptno = 40;

1 row updated.

SQL> select *
  2  from dept_temp2;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          

SQL> update dept_temp2
  2  set loc = 'SEOUL'
  3  where deptno = (select deptno from dept_temp2 where dname = 'OPERATIONS');

1 row updated.

SQL> select *
  2  from dept_temp2;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     SEOUL                                                                                                                                                                                                           

SQL> create table emp_temp2
  2  as select *
  3  from emp;

Table created.

SQL> desc emp_temp2;
 Name                                                                                                                                            Null?    Type
 ----------------------------------------------------------------------------------------------------------------------------------------------- -------- ------------------------------------------------------------------------------------------------
 EMPNO                                                                                                                                                    NUMBER(4)
 ENAME                                                                                                                                                    VARCHAR2(10)
 JOB                                                                                                                                                      VARCHAR2(9)
 MGR                                                                                                                                                      NUMBER(4)
 HIREDATE                                                                                                                                                 DATE
 SAL                                                                                                                                                      NUMBER(7,2)
 COMM                                                                                                                                                     NUMBER(7,2)
 DEPTNO                                                                                                                                                   NUMBER(2)

SQL> select *
  2  from emp_temp2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> delete from emp_temp2
  2  where job = 'MANAGER';

3 rows deleted.

SQL> select *
  2  from emp_temp2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

11 rows selected.

SQL> delete from emp_temp2
  2  where empno in (select e.empno from emp_temp2 e, salgrade s
  3  where e.sal between s.losal and s.hisal
  4  and s.grade =3
  5  and deptno = 30);

2 rows deleted.

SQL> select * from emp_temp2;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

9 rows selected.

SQL> delete from emp_temp2
  2  ;

9 rows deleted.

SQL> select *
  2  from emp_temp2;

no rows selected

SQL> select *
  2  from dept_temp;

    DEPTNO DNAME                          LOC                                                                                                                                                                                                             
---------- ------------------------------ --------------------------                                                                                                                                                                                      
        10 ACCOUNTING                     NEW YORK                                                                                                                                                                                                        
        20 RESEARCH                       DALLAS                                                                                                                                                                                                          
        30 SALES                          CHICAGO                                                                                                                                                                                                         
        40 OPERATIONS                     BOSTON                                                                                                                                                                                                          
        50 DATABASE                       SEOUL                                                                                                                                                                                                           
        70 WEB                                                                                                                                                                                                                                            
        80 MOBILE                                                                                                                                                                                                                                         
        90                                INCHEON                                                                                                                                                                                                         

8 rows selected.

SQL> create table chap10hw_emp as
  2   select *
  3   from emp;

Table created.

SQL> create table chap10hw_dept as
  2  select *
  3  from dept;

Table created.

SQL> create table chap10hw_salgrade as
  2  select *
  3  from salgrade;

Table created.

SQL> select *
  2  from chap10hw_emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> select avg(sal)
  2  from chap10hw_emp e, chap10hw_dept d
  3  where e.deptno = d.deptno
  4  and e.deptno = 20;

  AVG(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
      2175                                                                                                                                                                                                                                                

SQL> select avg(sal)
  2  from chap10hw_emp e, chap10hw_dept d
  3  where e.deptno = d.deptno
  4  and e.deptno = 30;

  AVG(SAL)                                                                                                                                                                                                                                                
----------                                                                                                                                                                                                                                                
1568.16667                                                                                                                                                                                                                                                

SQL> select *
  2  from chap10hw_emp
  3  where sal > (
  4  select avg(sal)
  5  from chap10hw_emp e, chap10hw_dept d
  6  where e.deptno = d.deptno
  7  and e.deptno = 20);

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                                                                   

6 rows selected.

SQL> update chap10hw_emp
  2  set deptno = 30
  3  where sal > (
  4  select avg(sal)
  5  from chap10hw_emp e, chap10hw_dept d
  6  where e.deptno = d.deptno
  7  and e.deptno = 20);

6 rows updated.

SQL> select *
  2  update chap10hw_emp
  3  set deptno = 30
  4  where sal > (
  5  select avg(sal)
  6  from chap10hw_emp e, chap10hw_dept d
  7  where e.deptno = d.deptno
  8  ;
update chap10hw_emp
*
ERROR at line 2:
ORA-00923: FROM keyword not found where expected 


SQL> select *
  2  from chap10hw_emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02       2975                    30                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    30                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    30                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5000                    30                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    30                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                                                                   

14 rows selected.

SQL> select min(hiredate)
  2  from chap10hw_emp e, chap10hw_dept d
  3  where e.deptno = d.deptno
  4  and deptno = 30;
and deptno = 30
    *
ERROR at line 4:
ORA-00918: column ambiguously defined 


SQL> select min(hiredate)
  2  from chap10hw_emp e, chap10hw_dept d
  3  where e.deptno = d.deptno
  4  and e.deptno = 30;

MIN(HIRE                                                                                                                                                                                                                                                  
--------                                                                                                                                                                                                                                                  
81/02/20                                                                                                                                                                                                                                                  

SQL> update chap10hw_emp
  2  set sal = sal *1.1, deptno = 20
  3  where hiredate > (
  4  select min(hiredate)
  5  from chap10hw_emp e, chap10hw_dept d
  6  where e.deptno = d.deptno
  7  and e.deptno = 30;
select min(hiredate)
*
ERROR at line 4:
ORA-00921: unexpected end of SQL command 


SQL> select min(hiredate)
  2  from chap10hw_emp e
  3  where e.deptno = 30;

MIN(HIRE                                                                                                                                                                                                                                                  
--------                                                                                                                                                                                                                                                  
81/02/20                                                                                                                                                                                                                                                  

SQL> update chap10hw_emp
  2  set sal = sal *1.1, deptno = 20
  3  where hiredate > (
  4  select min(hiredate)
  5  from chap10hw_emp e
  6  where e.deptno = 30;
select min(hiredate)
*
ERROR at line 4:
ORA-00921: unexpected end of SQL command 


SQL> update chap10hw_emp
  2  set sal = sal *1.1, deptno = 20
  3  where hiredate > (
  4  select min(hiredate)
  5  from chap10hw_emp e
  6  where e.deptno = 30 );

12 rows updated.

SQL> select *
  2  from chap10hw_emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                                                                   
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                                                                   
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                                                                   
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                                                                   
      7521 WARD                 SALESMAN                 7698 81/02/22     1384.9        500         20                                                                                                                                                   
      7566 JONES                MANAGER                  7839 81/04/02     3272.5                    20                                                                                                                                                   
      7654 MARTIN               SALESMAN                 7698 81/09/28       1375       1400         20                                                                                                                                                   
      7698 BLAKE                MANAGER                  7839 81/05/01       3135                    20                                                                                                                                                   
      7782 CLARK                MANAGER                  7839 81/06/09       2695                    20                                                                                                                                                   
      7788 SCOTT                ANALYST                  7566 87/04/19       3300                    20                                                                                                                                                   
      7839 KING                 PRESIDENT                     81/11/17       5500                    20                                                                                                                                                   
      7844 TURNER               SALESMAN                 7698 81/09/08       1650          0         20                                                                                                                                                   
      7876 ADAMS                CLERK                    7788 87/05/23       1210                    20                                                                                                                                                   
      7900 JAMES                CLERK                    7698 81/12/03       1045                    20                                                                                                                                                   
      7902 FORD                 ANALYST                  7566 81/12/03       3300                    20                                                                                                                                                   
      7934 MILLER               CLERK                    7782 82/01/23       1430                    20                                                                                                                                                   

14 rows selected.

SQL> spool off;
