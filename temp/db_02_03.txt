SQL> select *
  2  from emp
  3  where upper(ename) like upper('scott%');

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO                                                
---------- ---------- ----------                                                
      7788 SCOTT                ANALYST                  7566 87/04/19          
      3000                    20                                                
                                                                                

SQL> select *
  2  from emp
  3  where upper(ename) = upper('scott');

     EMPNO ENAME                JOB                       MGR HIREDATE          
---------- -------------------- ------------------ ---------- --------          
       SAL       COMM     DEPTNO                                                
---------- ---------- ----------                                                
      7788 SCOTT                ANALYST                  7566 87/04/19          
      3000                    20                                                
                                                                                

SQL> select length('한글'), lengthb('한글')
  2  from dual;

LENGTH('한글') LENGTHB('한글')                                                  
-------------- ---------------                                                  
             2               6                                                  

SQL> select length('한글'), lengthb('한글')
  2  from emp;

LENGTH('한글') LENGTHB('한글')                                                  
-------------- ---------------                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  

LENGTH('한글') LENGTHB('한글')                                                  
-------------- ---------------                                                  
             2               6                                                  
             2               6                                                  
             2               6                                                  

14 rows selected.

SQL> select ename, length(ename)
  2  from emp;

ENAME                LENGTH(ENAME)                                              
-------------------- -------------                                              
SMITH                            5                                              
ALLEN                            5                                              
WARD                             4                                              
JONES                            5                                              
MARTIN                           6                                              
BLAKE                            5                                              
CLARK                            5                                              
SCOTT                            5                                              
KING                             4                                              
TURNER                           6                                              
ADAMS                            5                                              

ENAME                LENGTH(ENAME)                                              
-------------------- -------------                                              
JAMES                            5                                              
FORD                             4                                              
MILLER                           6                                              

14 rows selected.

SQL> select ename, length(ename)
  2  from emp
  3  where length(ename) >= 5;

ENAME                LENGTH(ENAME)                                              
-------------------- -------------                                              
SMITH                            5                                              
ALLEN                            5                                              
JONES                            5                                              
MARTIN                           6                                              
BLAKE                            5                                              
CLARK                            5                                              
SCOTT                            5                                              
TURNER                           6                                              
ADAMS                            5                                              
JAMES                            5                                              
MILLER                           6                                              

11 rows selected.

SQL> select job, substr(job, 1, 2), substr(job, 3, 2), substr(job, 5)
  2  from emp;

JOB                SUBSTR(JOB,1,2)  SUBSTR(JOB,3,2)                             
------------------ ---------------- ----------------                            
SUBSTR(JOB,5)                                                                   
----------------------------------------                                        
CLERK              CL               ER                                          
K                                                                               
                                                                                
SALESMAN           SA               LE                                          
SMAN                                                                            
                                                                                
SALESMAN           SA               LE                                          
SMAN                                                                            
                                                                                

JOB                SUBSTR(JOB,1,2)  SUBSTR(JOB,3,2)                             
------------------ ---------------- ----------------                            
SUBSTR(JOB,5)                                                                   
----------------------------------------                                        
MANAGER            MA               NA                                          
GER                                                                             
                                                                                
SALESMAN           SA               LE                                          
SMAN                                                                            
                                                                                
MANAGER            MA               NA                                          
GER                                                                             
                                                                                

JOB                SUBSTR(JOB,1,2)  SUBSTR(JOB,3,2)                             
------------------ ---------------- ----------------                            
SUBSTR(JOB,5)                                                                   
----------------------------------------                                        
MANAGER            MA               NA                                          
GER                                                                             
                                                                                
ANALYST            AN               AL                                          
YST                                                                             
                                                                                
PRESIDENT          PR               ES                                          
IDENT                                                                           
                                                                                

JOB                SUBSTR(JOB,1,2)  SUBSTR(JOB,3,2)                             
------------------ ---------------- ----------------                            
SUBSTR(JOB,5)                                                                   
----------------------------------------                                        
SALESMAN           SA               LE                                          
SMAN                                                                            
                                                                                
CLERK              CL               ER                                          
K                                                                               
                                                                                
CLERK              CL               ER                                          
K                                                                               
                                                                                

JOB                SUBSTR(JOB,1,2)  SUBSTR(JOB,3,2)                             
------------------ ---------------- ----------------                            
SUBSTR(JOB,5)                                                                   
----------------------------------------                                        
ANALYST            AN               AL                                          
YST                                                                             
                                                                                
CLERK              CL               ER                                          
K                                                                               
                                                                                

14 rows selected.

SQL> select job,
  2  substr(job, -length(job)),
  3  substr(job, -length(job), 2),
  4  substr(job, -3)
  5  from emp;

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
CLERK                                                                           
CLERK                                                                           
CL               ERK                                                            
                                                                                
SALESMAN                                                                        
SALESMAN                                                                        
SA               MAN                                                            

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
                                                                                
SALESMAN                                                                        
SALESMAN                                                                        
SA               MAN                                                            
                                                                                
MANAGER                                                                         
MANAGER                                                                         

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
MA               GER                                                            
                                                                                
SALESMAN                                                                        
SALESMAN                                                                        
SA               MAN                                                            
                                                                                
MANAGER                                                                         

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
MANAGER                                                                         
MA               GER                                                            
                                                                                
MANAGER                                                                         
MANAGER                                                                         
MA               GER                                                            
                                                                                

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
ANALYST                                                                         
ANALYST                                                                         
AN               YST                                                            
                                                                                
PRESIDENT                                                                       
PRESIDENT                                                                       
PR               ENT                                                            

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
                                                                                
SALESMAN                                                                        
SALESMAN                                                                        
SA               MAN                                                            
                                                                                
CLERK                                                                           
CLERK                                                                           

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
CL               ERK                                                            
                                                                                
CLERK                                                                           
CLERK                                                                           
CL               ERK                                                            
                                                                                
ANALYST                                                                         

JOB                                                                             
------------------                                                              
SUBSTR(JOB,-LENGTH(JOB))                                                        
------------------------------------------------------------------------        
SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                 
---------------- ------------------------                                       
ANALYST                                                                         
AN               YST                                                            
                                                                                
CLERK                                                                           
CLERK                                                                           
CL               ERK                                                            
                                                                                

14 rows selected.

SQL> set linesize 250;
SQL> set pagesize 30;
SQL> select job,
  2  substr(job, -length(job)),
  3  substr(job, -length(job), 2),
  4  substr(job, -3)
  5  from emp;

JOB                SUBSTR(JOB,-LENGTH(JOB))                                                 SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                                                                                               
------------------ ------------------------------------------------------------------------ ---------------- ------------------------                                                                                                                     
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
MANAGER            MANAGER                                                                  MA               GER                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
MANAGER            MANAGER                                                                  MA               GER                                                                                                                                          
MANAGER            MANAGER                                                                  MA               GER                                                                                                                                          
ANALYST            ANALYST                                                                  AN               YST                                                                                                                                          
PRESIDENT          PRESIDENT                                                                PR               ENT                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          
ANALYST            ANALYST                                                                  AN               YST                                                                                                                                          
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          

14 rows selected.

SQL> set pagesize 20;
SQL> select job,
  2  substr(job, -length(job)),
  3  substr(job, -length(job), 2),
  4  substr(job, -3)
  5  from emp;

JOB                SUBSTR(JOB,-LENGTH(JOB))                                                 SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                                                                                               
------------------ ------------------------------------------------------------------------ ---------------- ------------------------                                                                                                                     
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
MANAGER            MANAGER                                                                  MA               GER                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
MANAGER            MANAGER                                                                  MA               GER                                                                                                                                          
MANAGER            MANAGER                                                                  MA               GER                                                                                                                                          
ANALYST            ANALYST                                                                  AN               YST                                                                                                                                          
PRESIDENT          PRESIDENT                                                                PR               ENT                                                                                                                                          
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                                                                          
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          
ANALYST            ANALYST                                                                  AN               YST                                                                                                                                          
CLERK              CLERK                                                                    CL               ERK                                                                                                                                          

14 rows selected.

SQL> set linesize 200;
SQL> select job,
  2  substr(job, -length(job)),
  3  substr(job, -length(job), 2),
  4  substr(job, -3)
  5  from emp;

JOB                SUBSTR(JOB,-LENGTH(JOB))                                                 SUBSTR(JOB,-LENG SUBSTR(JOB,-3)                                                                             
------------------ ------------------------------------------------------------------------ ---------------- ------------------------                                                                   
CLERK              CLERK                                                                    CL               ERK                                                                                        
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                        
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                        
MANAGER            MANAGER                                                                  MA               GER                                                                                        
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                        
MANAGER            MANAGER                                                                  MA               GER                                                                                        
MANAGER            MANAGER                                                                  MA               GER                                                                                        
ANALYST            ANALYST                                                                  AN               YST                                                                                        
PRESIDENT          PRESIDENT                                                                PR               ENT                                                                                        
SALESMAN           SALESMAN                                                                 SA               MAN                                                                                        
CLERK              CLERK                                                                    CL               ERK                                                                                        
CLERK              CLERK                                                                    CL               ERK                                                                                        
ANALYST            ANALYST                                                                  AN               YST                                                                                        
CLERK              CLERK                                                                    CL               ERK                                                                                        

14 rows selected.

SQL> select job, substr(job, 1, 2), substr(job, 3, 2), substr(job, 5)
  2  from emp;

JOB                SUBSTR(JOB,1,2)  SUBSTR(JOB,3,2)  SUBSTR(JOB,5)                                                                                                                                      
------------------ ---------------- ---------------- ----------------------------------------                                                                                                           
CLERK              CL               ER               K                                                                                                                                                  
SALESMAN           SA               LE               SMAN                                                                                                                                               
SALESMAN           SA               LE               SMAN                                                                                                                                               
MANAGER            MA               NA               GER                                                                                                                                                
SALESMAN           SA               LE               SMAN                                                                                                                                               
MANAGER            MA               NA               GER                                                                                                                                                
MANAGER            MA               NA               GER                                                                                                                                                
ANALYST            AN               AL               YST                                                                                                                                                
PRESIDENT          PR               ES               IDENT                                                                                                                                              
SALESMAN           SA               LE               SMAN                                                                                                                                               
CLERK              CL               ER               K                                                                                                                                                  
CLERK              CL               ER               K                                                                                                                                                  
ANALYST            AN               AL               YST                                                                                                                                                
CLERK              CL               ER               K                                                                                                                                                  

14 rows selected.

SQL> select instr('hello, oracle!', 'l') as instr_1,
  2  select instr('hello, oracle!', 'l', 5) as instr_2,
  3  select instr('hello, oracle!', 'l', 2) as instr_3,
  4  from dual;
select instr('hello, oracle!', 'l', 5) as instr_2,
*
ERROR at line 2:
ORA-00936: missing expression 


SQL> select instr('hello, oracle!', 'L') as instr_1,
  2  select instr('hello, oracle!', 'L', 5) as instr_2,
  3  select instr('hello, oracle!', 'L', 2) as instr_3,
  4  from dual;
select instr('hello, oracle!', 'L', 5) as instr_2,
*
ERROR at line 2:
ORA-00936: missing expression 


SQL> select INSTR('HELLO, ORACLE !', 'L')  AS INSTR_1,
  2  select INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
  3  select INSTR('HELLO, ORACLE !', 'L', 2, 2)  AS INSTR_3,
  4  from dual;
select INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
*
ERROR at line 2:
ORA-00936: missing expression 


SQL> SELECT INSTR('HELLO, ORACLE !', 'L')  AS INSTR_1,
  2  SELECT INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
  3  SELECT INSTR('HELLO, ORACLE !', 'L', 2, 2)  AS INSTR_3,
  4  FROM DUAL;
SELECT INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
*
ERROR at line 2:
ORA-00936: missing expression 


SQL> SELECT INSTR('HELLO, ORACLE !', 'L')  AS INSTR_1,
  2  SELECT INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
  3  SELECT INSTR('HELLO, ORACLE !', 'L', 2, 2)  AS INSTR_3
  4  FROM DUAL;
SELECT INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
*
ERROR at line 2:
ORA-00936: missing expression 


SQL> SELECT INSTR('HELLO, ORACLE !', 'L')  AS INSTR_1,
  2  INSTR('HELLO, ORACLE !', 'L', 5)  AS INSTR_2,
  3  INSTR('HELLO, ORACLE !', 'L', 2, 2)  AS INSTR_3
  4  FROM DUAL;

   INSTR_1    INSTR_2    INSTR_3                                                                                                                                                                        
---------- ---------- ----------                                                                                                                                                                        
         3         12          4                                                                                                                                                                        

SQL> select *
  2  from emp
  3  where instr(ename, 's') > 0;

no rows selected

SQL> select *
  2  from emp
  3  where instr(ename, 'S') > 0;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                 

SQL> select *
  2  from emp
  3  where ename like '%S%'
  4  ;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                 

SQL> select '010-1234-5678' as replace_before,
  2  replace('010-1234-5678', '-', ' ') as replace_1,
  3  replace('010-1234-5678', '-') as replace_2
  4  from dual;

REPLACE_BEFORE             REPLACE_1                  REPLACE_2                                                                                                                                         
-------------------------- -------------------------- ----------------------                                                                                                                            
010-1234-5678              010 1234 5678              01012345678                                                                                                                                       

SQL> select 'Oracle',
  2  lpad('Oracle', 10, '#') as lpad_1,
  3  rpad('Oracle', 10, '*') as rpad_1,
  4  lpad('Oracle', 10) as lpad_2,
  5  lpad('Oracle', 10) as rpad_2
  6  from dual;

'ORACLE'     LPAD_1               RPAD_1               LPAD_2               RPAD_2                                                                                                                      
------------ -------------------- -------------------- -------------------- --------------------                                                                                                        
Oracle       ####Oracle           Oracle****               Oracle               Oracle                                                                                                                  

SQL> select
  2  rpad('971225-', 14, '*') as rpad_jmno,
  3  rpad('010-1234-', 13, '*') as rpad_phone
  4  from dual;

RPAD_JMNO                    RPAD_PHONE                                                                                                                                                                 
---------------------------- --------------------------                                                                                                                                                 
971225-*******               010-1234-****                                                                                                                                                              

SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                 
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                 

14 rows selected.

SQL> select *
  2  from dual;

DU                                                                                                                                                                                                      
--                                                                                                                                                                                                      
X                                                                                                                                                                                                       

SQL> emp;
SP2-0042: unknown command "emp" - rest of line ignored.
SQL> select concat(empno, ename),
  2  concat(empno, concat(' : ', ename))
  3  from rmp
  4  where ename = 'scott';
from rmp
     *
ERROR at line 3:
ORA-00942: table or view does not exist 


SQL> select concat(empno, ename),
  2  concat(empno, concat(' : ', ename))
  3  from emp
  4  where ename = 'scott';

no rows selected

SQL> select concat(empno, ename),
  2  concat(empno, concat(' : ', ename))
  3  from emp
  4  where ename = 'SCOTT';

CONCAT(EMPNO,ENAME)                                                                                                                                                                                     
----------------------------------------------------------------------------------------------------                                                                                                    
CONCAT(EMPNO,CONCAT(':',ENAME))                                                                                                                                                                         
----------------------------------------------------------------------------------------------------------                                                                                              
7788SCOTT                                                                                                                                                                                               
7788 : SCOTT                                                                                                                                                                                            
                                                                                                                                                                                                        

SQL> 
SQL> select concat(empno, ename),
  2  concat(empno, concat(' : ', ename))
  3  from emp
  4  where ename = 'SCOTT';

CONCAT(EMPNO,ENAME)                                                                                                                                                                                     
----------------------------------------------------------------------------------------------------                                                                                                    
CONCAT(EMPNO,CONCAT(':',ENAME))                                                                                                                                                                         
----------------------------------------------------------------------------------------------------------                                                                                              
7788SCOTT                                                                                                                                                                                               
7788 : SCOTT                                                                                                                                                                                            
                                                                                                                                                                                                        

SQL> desc dual;
 Name                                                                                                              Null?    Type
 ----------------------------------------------------------------------------------------------------------------- -------- ----------------------------------------------------------------------------
 DUMMY                                                                                                                      VARCHAR2(1)

SQL> select empno || ename,
  2  empno || ' : ' || ename
  3  from ...
  4  ;
from ...
     *
ERROR at line 3:
ORA-00903: invalid table name 


SQL> select empno || ename,
  2  empno || ' : ' || ename
  3  from emp;

EMPNO||ENAME                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------                                                                                                    
EMPNO||':'||ENAME                                                                                                                                                                                       
----------------------------------------------------------------------------------------------------------                                                                                              
7369SMITH                                                                                                                                                                                               
7369 : SMITH                                                                                                                                                                                            
                                                                                                                                                                                                        
7499ALLEN                                                                                                                                                                                               
7499 : ALLEN                                                                                                                                                                                            
                                                                                                                                                                                                        
7521WARD                                                                                                                                                                                                
7521 : WARD                                                                                                                                                                                             
                                                                                                                                                                                                        
7566JONES                                                                                                                                                                                               
7566 : JONES                                                                                                                                                                                            
                                                                                                                                                                                                        
7654MARTIN                                                                                                                                                                                              
7654 : MARTIN                                                                                                                                                                                           
                                                                                                                                                                                                        

EMPNO||ENAME                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------                                                                                                    
EMPNO||':'||ENAME                                                                                                                                                                                       
----------------------------------------------------------------------------------------------------------                                                                                              
7698BLAKE                                                                                                                                                                                               
7698 : BLAKE                                                                                                                                                                                            
                                                                                                                                                                                                        
7782CLARK                                                                                                                                                                                               
7782 : CLARK                                                                                                                                                                                            
                                                                                                                                                                                                        
7788SCOTT                                                                                                                                                                                               
7788 : SCOTT                                                                                                                                                                                            
                                                                                                                                                                                                        
7839KING                                                                                                                                                                                                
7839 : KING                                                                                                                                                                                             
                                                                                                                                                                                                        
7844TURNER                                                                                                                                                                                              
7844 : TURNER                                                                                                                                                                                           
                                                                                                                                                                                                        

EMPNO||ENAME                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------                                                                                                    
EMPNO||':'||ENAME                                                                                                                                                                                       
----------------------------------------------------------------------------------------------------------                                                                                              
7876ADAMS                                                                                                                                                                                               
7876 : ADAMS                                                                                                                                                                                            
                                                                                                                                                                                                        
7900JAMES                                                                                                                                                                                               
7900 : JAMES                                                                                                                                                                                            
                                                                                                                                                                                                        
7902FORD                                                                                                                                                                                                
7902 : FORD                                                                                                                                                                                             
                                                                                                                                                                                                        
7934MILLER                                                                                                                                                                                              
7934 : MILLER                                                                                                                                                                                           
                                                                                                                                                                                                        

14 rows selected.

SQL> select '[' || trim(' _ _Oracle_ _ ') || ']' as trim,
  2  '[' || trim(leading from ' _ _Oracle_ _ ') || ']' as trim_leading,
  3  '[' || trim(trailing from ' _ _Oracle_ _ ') || ']' as trim_trailing,
  4  '[' || trim(both from ' _ _Oracle_ _ ') || ']' as trim_both,
  5  from dual;
from dual
*
ERROR at line 5:
ORA-00936: missing expression 


SQL> select '[' || trim(' _ _Oracle_ _ ') || ']' as trim,
  2  '[' || trim(leading from ' _ _Oracle_ _ ') || ']' as trim_leading,
  3  '[' || trim(trailing from ' _ _Oracle_ _ ') || ']' as trim_trailing,
  4  '[' || trim(both from ' _ _Oracle_ _ ') || ']' as trim_both
  5  from dual;

TRIM                         TRIM_LEADING                   TRIM_TRAILING                  TRIM_BOTH                                                                                                    
---------------------------- ------------------------------ ------------------------------ ----------------------------                                                                                 
[_ _Oracle_ _]               [_ _Oracle_ _ ]                [ _ _Oracle_ _]                [_ _Oracle_ _]                                                                                               

SQL> select '[' || trim('_' from ' _ _Oracle_ _ ') || ']' as trim,
  2  '[' || trim(leading '_' from ' _ _Oracle_ _ ') || ']' as trim_leading,
  3  '[' || trim(trailing '_' from ' _ _Oracle_ _ ') || ']' as trim_trailing,
  4  '[' || trim(both '_' from ' _ _Oracle_ _ ') || ']' as trim_both
  5  from dual;

TRIM                             TRIM_LEADING                     TRIM_TRAILING                    TRIM_BOTH                                                                                            
-------------------------------- -------------------------------- -------------------------------- --------------------------------                                                                     
[ _ _Oracle_ _ ]                 [ _ _Oracle_ _ ]                 [ _ _Oracle_ _ ]                 [ _ _Oracle_ _ ]                                                                                     

SQL> select '[' || trim('_' from '_ _Oracle_ _') || ']' as trim,
  2  '[' || trim(leading '_' from '_ _Oracle_ _') || ']' as trim_leading,
  3  '[' || trim(trailing '_' from '_ _Oracle_ _') || ']' as trim_trailing,
  4  '[' || trim(both '_' from '_ _Oracle_ _') || ']' as trim_both
  5  from dual;

TRIM                     TRIM_LEADING               TRIM_TRAILING              TRIM_BOTH                                                                                                                
------------------------ -------------------------- -------------------------- ------------------------                                                                                                 
[ _Oracle_ ]             [ _Oracle_ _]              [_ _Oracle_ ]              [ _Oracle_ ]                                                                                                             

SQL> select '[' || trim('_ _Oracle_ _') || ']' as trim,
  2  '[' || trim(leading from '_ _Oracle_ _') || ']' as trim_leading,
  3  '[' || trim(trailing from '_ _Oracle_ _') || ']' as trim_trailing,
  4  '[' || trim(both from '_ _Oracle_ _') || ']' as trim_both
  5  from dual;

TRIM                         TRIM_LEADING                 TRIM_TRAILING                TRIM_BOTH                                                                                                        
---------------------------- ---------------------------- ---------------------------- ----------------------------                                                                                     
[_ _Oracle_ _]               [_ _Oracle_ _]               [_ _Oracle_ _]               [_ _Oracle_ _]                                                                                                   

SQL> select '[' || trim(' _ _Oracle_ _ ') || ']' as trim,
  2  '[' || trim(leading from ' _ _Oracle_ _ ') || ']' as trim_leading,
  3  '[' || trim(trailing from ' _ _Oracle_ _ ') || ']' as trim_trailing,
  4  '[' || trim(both from ' _ _Oracle_ _ ') || ']' as trim_both
  5  from dual;

TRIM                         TRIM_LEADING                   TRIM_TRAILING                  TRIM_BOTH                                                                                                    
---------------------------- ------------------------------ ------------------------------ ----------------------------                                                                                 
[_ _Oracle_ _]               [_ _Oracle_ _ ]                [ _ _Oracle_ _]                [_ _Oracle_ _]                                                                                               

SQL> select '[' || trim(' _Oracle_ ') || ']' as trim,
  2  '[' || ltrim(' _Oracle_ ') || ']' as ltrim,
  3  '[' || ltrim('<_Oracle_>', '_<') || ']' as ltrim_2,
  4  '[' || rtrim(' _Oracle_ ') || ']' as rtrim,
  5  '[' || rtrim('<_Oracle_>', '_>') || ']' as rtrim_2,
  6  from dual;
from dual
*
ERROR at line 6:
ORA-00936: missing expression 


SQL> select '[' || trim(' _Oracle_ ') || ']' as trim,
  2  '[' || ltrim(' _Oracle_ ') || ']' as ltrim,
  3  '[' || ltrim('<_Oracle_>', '_<') || ']' as ltrim_2,
  4  '[' || rtrim(' _Oracle_ ') || ']' as rtrim,
  5  '[' || rtrim('<_Oracle_>', '_>') || ']' as rtrim_2
  6  from dual;

TRIM                 LTRIM                  LTRIM_2              RTRIM                  RTRIM_2                                                                                                         
-------------------- ---------------------- -------------------- ---------------------- --------------------                                                                                            
[_Oracle_]           [_Oracle_ ]            [Oracle_>]           [ _Oracle_]            [<_Oracle]                                                                                                      

SQL> select round(1234.5678) as round,
  2  round(1234.5678, 0) as round_0,
  3  round(1234.5678, 1) as round_1,
  4  round(1234.5678, 2) as round_2,
  5  round(1234.5678, -1) as round_minus1,
  6  round(1234.5678, -2) as round_minus2,
  7  from dual;
from dual
*
ERROR at line 7:
ORA-00936: missing expression 


SQL> select round(1234.5678) as round,
  2  round(1234.5678, 0) as round_0,
  3  round(1234.5678, 1) as round_1,
  4  round(1234.5678, 2) as round_2,
  5  round(1234.5678, -1) as round_minus1,
  6  round(1234.5678, -2) as round_minus2
  7  from dual;

     ROUND    ROUND_0    ROUND_1    ROUND_2 ROUND_MINUS1 ROUND_MINUS2                                                                                                                                   
---------- ---------- ---------- ---------- ------------ ------------                                                                                                                                   
      1235       1235     1234.6    1234.57         1230         1200                                                                                                                                   

SQL> select sysdate,
  2  add_months(sysdate, 3)
  3  from dual;

SYSDATE  ADD_MONT                                                                                                                                                                                       
-------- --------                                                                                                                                                                                       
22/02/03 22/05/03                                                                                                                                                                                       

SQL> select empno, ename, hiredate,
  2  add_months(hiredate, 120) as work10year
  3  from emp;

     EMPNO ENAME                HIREDATE WORK10YE                                                                                                                                                       
---------- -------------------- -------- --------                                                                                                                                                       
      7369 SMITH                80/12/17 90/12/17                                                                                                                                                       
      7499 ALLEN                81/02/20 91/02/20                                                                                                                                                       
      7521 WARD                 81/02/22 91/02/22                                                                                                                                                       
      7566 JONES                81/04/02 91/04/02                                                                                                                                                       
      7654 MARTIN               81/09/28 91/09/28                                                                                                                                                       
      7698 BLAKE                81/05/01 91/05/01                                                                                                                                                       
      7782 CLARK                81/06/09 91/06/09                                                                                                                                                       
      7788 SCOTT                87/04/19 97/04/19                                                                                                                                                       
      7839 KING                 81/11/17 91/11/17                                                                                                                                                       
      7844 TURNER               81/09/08 91/09/08                                                                                                                                                       
      7876 ADAMS                87/05/23 97/05/23                                                                                                                                                       
      7900 JAMES                81/12/03 91/12/03                                                                                                                                                       
      7902 FORD                 81/12/03 91/12/03                                                                                                                                                       
      7934 MILLER               82/01/23 92/01/23                                                                                                                                                       

14 rows selected.

SQL> select empno, ename, empno + '500'
  2  from emp
  3  where ename = 'SCOTT';

     EMPNO ENAME                EMPNO+'500'                                                                                                                                                             
---------- -------------------- -----------                                                                                                                                                             
      7788 SCOTT                       8288                                                                                                                                                             

SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                 
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                 

14 rows selected.

SQL> select empno, ename, hiredate, add_months(hiredate,3) as r_job, comm
  2  from emp;

     EMPNO ENAME                HIREDATE R_JOB          COMM                                                                                                                                            
---------- -------------------- -------- -------- ----------                                                                                                                                            
      7369 SMITH                80/12/17 81/03/17                                                                                                                                                       
      7499 ALLEN                81/02/20 81/05/20        300                                                                                                                                            
      7521 WARD                 81/02/22 81/05/22        500                                                                                                                                            
      7566 JONES                81/04/02 81/07/02                                                                                                                                                       
      7654 MARTIN               81/09/28 81/12/28       1400                                                                                                                                            
      7698 BLAKE                81/05/01 81/08/01                                                                                                                                                       
      7782 CLARK                81/06/09 81/09/09                                                                                                                                                       
      7788 SCOTT                87/04/19 87/07/19                                                                                                                                                       
      7839 KING                 81/11/17 82/02/17                                                                                                                                                       
      7844 TURNER               81/09/08 81/12/08          0                                                                                                                                            
      7876 ADAMS                87/05/23 87/08/23                                                                                                                                                       
      7900 JAMES                81/12/03 82/03/03                                                                                                                                                       
      7902 FORD                 81/12/03 82/03/03                                                                                                                                                       
      7934 MILLER               82/01/23 82/04/23                                                                                                                                                       

14 rows selected.

SQL> select empno, ename, hiredate, add_months(hiredate,3) as r_job, comm, to_char(sysdate, 'YYYY-MM-DD') as job2
  2  from emp;

     EMPNO ENAME                HIREDATE R_JOB          COMM JOB2                                                                                                                                       
---------- -------------------- -------- -------- ---------- --------------------                                                                                                                       
      7369 SMITH                80/12/17 81/03/17            2022-02-03                                                                                                                                 
      7499 ALLEN                81/02/20 81/05/20        300 2022-02-03                                                                                                                                 
      7521 WARD                 81/02/22 81/05/22        500 2022-02-03                                                                                                                                 
      7566 JONES                81/04/02 81/07/02            2022-02-03                                                                                                                                 
      7654 MARTIN               81/09/28 81/12/28       1400 2022-02-03                                                                                                                                 
      7698 BLAKE                81/05/01 81/08/01            2022-02-03                                                                                                                                 
      7782 CLARK                81/06/09 81/09/09            2022-02-03                                                                                                                                 
      7788 SCOTT                87/04/19 87/07/19            2022-02-03                                                                                                                                 
      7839 KING                 81/11/17 82/02/17            2022-02-03                                                                                                                                 
      7844 TURNER               81/09/08 81/12/08          0 2022-02-03                                                                                                                                 
      7876 ADAMS                87/05/23 87/08/23            2022-02-03                                                                                                                                 
      7900 JAMES                81/12/03 82/03/03            2022-02-03                                                                                                                                 
      7902 FORD                 81/12/03 82/03/03            2022-02-03                                                                                                                                 
      7934 MILLER               82/01/23 82/04/23            2022-02-03                                                                                                                                 

14 rows selected.

SQL> select empno, ename, hiredate, add_months(hiredate,3) as r_job, comm, to_char(sysdate, 'YYYY-MM-DD') as job2
  2  from emp;

     EMPNO ENAME                HIREDATE R_JOB          COMM JOB2                                                                                                                                       
---------- -------------------- -------- -------- ---------- --------------------                                                                                                                       
      7369 SMITH                80/12/17 81/03/17            2022-02-03                                                                                                                                 
      7499 ALLEN                81/02/20 81/05/20        300 2022-02-03                                                                                                                                 
      7521 WARD                 81/02/22 81/05/22        500 2022-02-03                                                                                                                                 
      7566 JONES                81/04/02 81/07/02            2022-02-03                                                                                                                                 
      7654 MARTIN               81/09/28 81/12/28       1400 2022-02-03                                                                                                                                 
      7698 BLAKE                81/05/01 81/08/01            2022-02-03                                                                                                                                 
      7782 CLARK                81/06/09 81/09/09            2022-02-03                                                                                                                                 
      7788 SCOTT                87/04/19 87/07/19            2022-02-03                                                                                                                                 
      7839 KING                 81/11/17 82/02/17            2022-02-03                                                                                                                                 
      7844 TURNER               81/09/08 81/12/08          0 2022-02-03                                                                                                                                 
      7876 ADAMS                87/05/23 87/08/23            2022-02-03                                                                                                                                 
      7900 JAMES                81/12/03 82/03/03            2022-02-03                                                                                                                                 
      7902 FORD                 81/12/03 82/03/03            2022-02-03                                                                                                                                 
      7934 MILLER               82/01/23 82/04/23            2022-02-03                                                                                                                                 

14 rows selected.

SQL> select empno, ename, hiredate, add_months(hiredate,3, 'YYYY-MM-DD') as r_job, comm, to_char(sysdate, 'YYYY-MM-DD') as job2
  2  from emp;
select empno, ename, hiredate, add_months(hiredate,3, 'YYYY-MM-DD') as r_job, comm, to_char(sysdate, 'YYYY-MM-DD') as job2
                               *
ERROR at line 1:
ORA-00909: invalid number of arguments 


SQL> select empno, ename, hiredate, add_months(hiredate,3) as r_job, comm, to_char(r_job, 'YYYY-MM-DD') as job2
  2  from emp;
select empno, ename, hiredate, add_months(hiredate,3) as r_job, comm, to_char(r_job, 'YYYY-MM-DD') as job2
                                                                              *
ERROR at line 1:
ORA-00904: "R_JOB": invalid identifier 


SQL> select empno, ename, hiredate, to_char(add_months(hiredate,3), 'YYYY-MM-DD') as r_job, comm
  2  from emp;

     EMPNO ENAME                HIREDATE R_JOB                      COMM                                                                                                                                
---------- -------------------- -------- -------------------- ----------                                                                                                                                
      7369 SMITH                80/12/17 1981-03-17                                                                                                                                                     
      7499 ALLEN                81/02/20 1981-05-20                  300                                                                                                                                
      7521 WARD                 81/02/22 1981-05-22                  500                                                                                                                                
      7566 JONES                81/04/02 1981-07-02                                                                                                                                                     
      7654 MARTIN               81/09/28 1981-12-28                 1400                                                                                                                                
      7698 BLAKE                81/05/01 1981-08-01                                                                                                                                                     
      7782 CLARK                81/06/09 1981-09-09                                                                                                                                                     
      7788 SCOTT                87/04/19 1987-07-19                                                                                                                                                     
      7839 KING                 81/11/17 1982-02-17                                                                                                                                                     
      7844 TURNER               81/09/08 1981-12-08                    0                                                                                                                                
      7876 ADAMS                87/05/23 1987-08-23                                                                                                                                                     
      7900 JAMES                81/12/03 1982-03-03                                                                                                                                                     
      7902 FORD                 81/12/03 1982-03-03                                                                                                                                                     
      7934 MILLER               82/01/23 1982-04-23                                                                                                                                                     

14 rows selected.

SQL> select empno, ename, hiredate, to_char(add_months(hiredate,3), 'YYYY-MM-DD') as r_job, nvl(to char(comm), 'N/A') as comm
  2  from emp;
select empno, ename, hiredate, to_char(add_months(hiredate,3), 'YYYY-MM-DD') as r_job, nvl(to char(comm), 'N/A') as comm
                                                                                           *
ERROR at line 1:
ORA-00936: missing expression 


SQL> select empno, ename, hiredate, to_char(add_months(hiredate,3), 'YYYY-MM-DD') as r_job,
  2  nvl(to_char(comm), 'N/A') as comm
  3  from emp;

     EMPNO ENAME                HIREDATE R_JOB                COMM                                                                                                                                      
---------- -------------------- -------- -------------------- --------------------------------------------------------------------------------                                                          
      7369 SMITH                80/12/17 1981-03-17           N/A                                                                                                                                       
      7499 ALLEN                81/02/20 1981-05-20           300                                                                                                                                       
      7521 WARD                 81/02/22 1981-05-22           500                                                                                                                                       
      7566 JONES                81/04/02 1981-07-02           N/A                                                                                                                                       
      7654 MARTIN               81/09/28 1981-12-28           1400                                                                                                                                      
      7698 BLAKE                81/05/01 1981-08-01           N/A                                                                                                                                       
      7782 CLARK                81/06/09 1981-09-09           N/A                                                                                                                                       
      7788 SCOTT                87/04/19 1987-07-19           N/A                                                                                                                                       
      7839 KING                 81/11/17 1982-02-17           N/A                                                                                                                                       
      7844 TURNER               81/09/08 1981-12-08           0                                                                                                                                         
      7876 ADAMS                87/05/23 1987-08-23           N/A                                                                                                                                       
      7900 JAMES                81/12/03 1982-03-03           N/A                                                                                                                                       
      7902 FORD                 81/12/03 1982-03-03           N/A                                                                                                                                       
      7934 MILLER               82/01/23 1982-04-23           N/A                                                                                                                                       

14 rows selected.

SQL> select sum(sal)
  2  from emp;

  SUM(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
     29034                                                                                                                                                                                              

SQL> select ename,sum(sal)
  2  from emp;
select ename,sum(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> --ex 7-4
SQL> select sum(distinct sal), sum(all sal), sum(sal) from emp;

SUM(DISTINCTSAL) SUM(ALLSAL)   SUM(SAL)                                                                                                                                                                 
---------------- ----------- ----------                                                                                                                                                                 
           26034       29034      29034                                                                                                                                                                 

SQL> select count(*)
  2  from emp;

  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        14                                                                                                                                                                                              

SQL> --ex 7-6
SQL> select count(*)
  2  from emp
  3  where deptno = 30;

  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         6                                                                                                                                                                                              

SQL> --ex 7-7
SQL> select count(distinct job),
  2  count(all job),
  3  count(job)
  4  from emp;

COUNT(DISTINCTJOB) COUNT(ALLJOB) COUNT(JOB)                                                                                                                                                             
------------------ ------------- ----------                                                                                                                                                             
                 5            14         14                                                                                                                                                             

SQL> select count(comm)
  2  from emp;

COUNT(COMM)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
          4                                                                                                                                                                                             

SQL> 
SQL> select count(comm)
  2  from emp
  3  where comm is not null;

COUNT(COMM)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
          4                                                                                                                                                                                             

SQL> --ex 7-10
SQL> select max(sal)
  2  from emp
  3  where deptno = 10;

  MAX(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      5000                                                                                                                                                                                              

SQL> --ex 7-11
SQL> select min(sal)
  2  from emp
  3  where deptno = 10;

  MIN(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      1300                                                                                                                                                                                              

SQL> --ex 7-12
SQL> select max(hiredate)
  2  from emp;

MAX(HIRE                                                                                                                                                                                                
--------                                                                                                                                                                                                
87/05/23                                                                                                                                                                                                

SQL> where deptno = 20;
SP2-0734: unknown command beginning "where dept..." - rest of line ignored.
SQL> --ex 7-12
SQL> select max(hiredate)
  2  from emp
  3  where deptno = 20;

MAX(HIRE                                                                                                                                                                                                
--------                                                                                                                                                                                                
87/05/23                                                                                                                                                                                                

SQL> select to_char(max(hiredate), 'YYYY-MM-DD') as a
  2  from emp
  3  where deptno = 20;

A                                                                                                                                                                                                       
--------------------                                                                                                                                                                                    
1987-05-23                                                                                                                                                                                              

SQL> --ex 7-13
SQL> select min(hiredate)
  2  from emp
  3  where deptno = 20;

MIN(HIRE                                                                                                                                                                                                
--------                                                                                                                                                                                                
80/12/17                                                                                                                                                                                                

SQL> 
SQL> --ex 7-14
SQL> select avg(sal)
  2  from emp
  3  where deptno = 30;

  AVG(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
1568.16667                                                                                                                                                                                              

SQL> select avg(distinct sal)
  2  from emp
  3  where deptno = 30;

AVG(DISTINCTSAL)                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      1568.16667                                                                                                                                                                                        

SQL> SELECT AVG(DISTINCT SAL)
  2  from emp
  3  where deptno = 30;

AVG(DISTINCTSAL)                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      1568.16667                                                                                                                                                                                        

SQL> select avg(sal), deptno
  2  from emp
  3  group by deptno;

  AVG(SAL)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
1568.16667         30                                                                                                                                                                                   
      2175         20                                                                                                                                                                                   
2916.66667         10                                                                                                                                                                                   

SQL> select ename, avg(sal), deptno
  2  from emp
  3  group by deptno;
select ename, avg(sal), deptno
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select ename, avg(sal), deptno
  2  from emp
  3  group by deptno, ename;

ENAME                  AVG(SAL)     DEPTNO                                                                                                                                                              
-------------------- ---------- ----------                                                                                                                                                              
JONES                      2975         20                                                                                                                                                              
WARD                       1259         30                                                                                                                                                              
SCOTT                      3000         20                                                                                                                                                              
KING                       5000         10                                                                                                                                                              
JAMES                       950         30                                                                                                                                                              
ALLEN                      1600         30                                                                                                                                                              
MARTIN                     1250         30                                                                                                                                                              
BLAKE                      2850         30                                                                                                                                                              
FORD                       3000         20                                                                                                                                                              
SMITH                       800         20                                                                                                                                                              
ADAMS                      1100         20                                                                                                                                                              
MILLER                     1300         10                                                                                                                                                              
CLARK                      2450         10                                                                                                                                                              
TURNER                     1500         30                                                                                                                                                              

14 rows selected.

SQL> select ename, avg(sal), deptno
  2  from emp
  3  group by deptno, ename
  4  order by deptno;

ENAME                  AVG(SAL)     DEPTNO                                                                                                                                                              
-------------------- ---------- ----------                                                                                                                                                              
CLARK                      2450         10                                                                                                                                                              
KING                       5000         10                                                                                                                                                              
MILLER                     1300         10                                                                                                                                                              
ADAMS                      1100         20                                                                                                                                                              
FORD                       3000         20                                                                                                                                                              
JONES                      2975         20                                                                                                                                                              
SCOTT                      3000         20                                                                                                                                                              
SMITH                       800         20                                                                                                                                                              
ALLEN                      1600         30                                                                                                                                                              
BLAKE                      2850         30                                                                                                                                                              
JAMES                       950         30                                                                                                                                                              
MARTIN                     1250         30                                                                                                                                                              
TURNER                     1500         30                                                                                                                                                              
WARD                       1259         30                                                                                                                                                              

14 rows selected.

SQL> select ename, avg(sal), deptno
  2  from emp
  3  group by deptno, ename
  4  order by deptno,avg(sal);

ENAME                  AVG(SAL)     DEPTNO                                                                                                                                                              
-------------------- ---------- ----------                                                                                                                                                              
MILLER                     1300         10                                                                                                                                                              
CLARK                      2450         10                                                                                                                                                              
KING                       5000         10                                                                                                                                                              
SMITH                       800         20                                                                                                                                                              
ADAMS                      1100         20                                                                                                                                                              
JONES                      2975         20                                                                                                                                                              
SCOTT                      3000         20                                                                                                                                                              
FORD                       3000         20                                                                                                                                                              
JAMES                       950         30                                                                                                                                                              
MARTIN                     1250         30                                                                                                                                                              
WARD                       1259         30                                                                                                                                                              
TURNER                     1500         30                                                                                                                                                              
ALLEN                      1600         30                                                                                                                                                              
BLAKE                      2850         30                                                                                                                                                              

14 rows selected.

SQL> select job, avg(sal), deptno
  2  from emp
  3  group by deptno, job
  4  order by deptno,avg(sal);

JOB                  AVG(SAL)     DEPTNO                                                                                                                                                                
------------------ ---------- ----------                                                                                                                                                                
CLERK                    1300         10                                                                                                                                                                
MANAGER                  2450         10                                                                                                                                                                
PRESIDENT                5000         10                                                                                                                                                                
CLERK                     950         20                                                                                                                                                                
MANAGER                  2975         20                                                                                                                                                                
ANALYST                  3000         20                                                                                                                                                                
CLERK                     950         30                                                                                                                                                                
SALESMAN              1402.25         30                                                                                                                                                                
MANAGER                  2850         30                                                                                                                                                                

9 rows selected.

SQL> select deptno, job, avg(sal)
  2  from emp
  3  group by deptno, job
  4  having avg(sal) >= 2000
  5  order by deptno, job;

    DEPTNO JOB                  AVG(SAL)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        10 PRESIDENT                5000                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                

SQL> select deptno, job, avg(sal)
  2  from emp
  3  where sal <= 3000
  4  ;
select deptno, job, avg(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select deptno, job, avg(sal)
  2  from emp
  3  where sal <= 3000;
select deptno, job, avg(sal)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> select deptno, job, sal
  2  from emp
  3  where sal <= 3000;

    DEPTNO JOB                       SAL                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        20 CLERK                     800                                                                                                                                                                
        30 SALESMAN                 1600                                                                                                                                                                
        30 SALESMAN                 1259                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 SALESMAN                 1250                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        30 SALESMAN                 1500                                                                                                                                                                
        20 CLERK                    1100                                                                                                                                                                
        30 CLERK                     950                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        10 CLERK                    1300                                                                                                                                                                

13 rows selected.

SQL> select deptno, job, avg(sal)
  2  from emp
  3  where sal <= 3000
  4  group by deptno, job
  5  having avg(sal) >=2000
  6  order by deptno,job;

    DEPTNO JOB                  AVG(SAL)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                

SQL> select deptno,job,sal
  2  from emp
  3  where sal >= 2000;

    DEPTNO JOB                       SAL                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        10 PRESIDENT                5000                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                

6 rows selected.

SQL> group by deptno, job
SP2-0734: unknown command beginning "group by d..." - rest of line ignored.
SQL> order by deptno,job;
SP2-0734: unknown command beginning "order by d..." - rest of line ignored.
SQL> select deptno,job,sal
  2  from emp
  3  where sal >= 2000
  4  group by deptno, job
  5  order by deptno,job;
select deptno,job,sal
                  *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select deptno,job,avg(sal)
  2  from emp
  3  where sal >= 2000
  4  group by deptno, job
  5  order by deptno,job;

    DEPTNO JOB                  AVG(SAL)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        10 PRESIDENT                5000                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                

SQL> select deptno,job,avg(sal)
  2  from emp
  3  where sal <= 3000
  4  group by deptno, job
  5  order by deptno,job;

    DEPTNO JOB                  AVG(SAL)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 CLERK                    1300                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        20 CLERK                     950                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 CLERK                     950                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                
        30 SALESMAN              1402.25                                                                                                                                                                

8 rows selected.

SQL> select deptno, job, count(*), max(sal), sum(sal), avg(sal)
  2  from emp
  3  group by deptno, job
  4  order by deptno, job;

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL)                                                                                                                               
---------- ------------------ ---------- ---------- ---------- ----------                                                                                                                               
        10 CLERK                       1       1300       1300       1300                                                                                                                               
        10 MANAGER                     1       2450       2450       2450                                                                                                                               
        10 PRESIDENT                   1       5000       5000       5000                                                                                                                               
        20 ANALYST                     2       3000       6000       3000                                                                                                                               
        20 CLERK                       2       1100       1900        950                                                                                                                               
        20 MANAGER                     1       2975       2975       2975                                                                                                                               
        30 CLERK                       1        950        950        950                                                                                                                               
        30 MANAGER                     1       2850       2850       2850                                                                                                                               
        30 SALESMAN                    4       1600       5609    1402.25                                                                                                                               

9 rows selected.

SQL> select deptno, job, count(*), max(sal), sum(sal), avg(sal)
  2  from emp
  3  group by rollup(deptno, job);

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL)                                                                                                                               
---------- ------------------ ---------- ---------- ---------- ----------                                                                                                                               
        10 CLERK                       1       1300       1300       1300                                                                                                                               
        10 MANAGER                     1       2450       2450       2450                                                                                                                               
        10 PRESIDENT                   1       5000       5000       5000                                                                                                                               
        10                             3       5000       8750 2916.66667                                                                                                                               
        20 CLERK                       2       1100       1900        950                                                                                                                               
        20 ANALYST                     2       3000       6000       3000                                                                                                                               
        20 MANAGER                     1       2975       2975       2975                                                                                                                               
        20                             5       3000      10875       2175                                                                                                                               
        30 CLERK                       1        950        950        950                                                                                                                               
        30 MANAGER                     1       2850       2850       2850                                                                                                                               
        30 SALESMAN                    4       1600       5609    1402.25                                                                                                                               
        30                             6       2850       9409 1568.16667                                                                                                                               
                                      14       5000      29034 2073.85714                                                                                                                               

13 rows selected.

SQL> select deptno, job, count(*), max(sal), sum(sal), avg(sal)
  2  from emp
  3  group by cube(deptno, job)
  4  order by deptno, job;

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL)                                                                                                                               
---------- ------------------ ---------- ---------- ---------- ----------                                                                                                                               
        10 CLERK                       1       1300       1300       1300                                                                                                                               
        10 MANAGER                     1       2450       2450       2450                                                                                                                               
        10 PRESIDENT                   1       5000       5000       5000                                                                                                                               
        10                             3       5000       8750 2916.66667                                                                                                                               
        20 ANALYST                     2       3000       6000       3000                                                                                                                               
        20 CLERK                       2       1100       1900        950                                                                                                                               
        20 MANAGER                     1       2975       2975       2975                                                                                                                               
        20                             5       3000      10875       2175                                                                                                                               
        30 CLERK                       1        950        950        950                                                                                                                               
        30 MANAGER                     1       2850       2850       2850                                                                                                                               
        30 SALESMAN                    4       1600       5609    1402.25                                                                                                                               
        30                             6       2850       9409 1568.16667                                                                                                                               
           ANALYST                     2       3000       6000       3000                                                                                                                               
           CLERK                       4       1300       4150     1037.5                                                                                                                               
           MANAGER                     3       2975       8275 2758.33333                                                                                                                               
           PRESIDENT                   1       5000       5000       5000                                                                                                                               
           SALESMAN                    4       1600       5609    1402.25                                                                                                                               

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL)                                                                                                                               
---------- ------------------ ---------- ---------- ---------- ----------                                                                                                                               
                                      14       5000      29034 2073.85714                                                                                                                               

18 rows selected.

SQL> select deptno, job, count(*), max(sal), sum(sal), avg(sal)
  2  from emp
  3  group by cube(job, deptno)
  4  order by deptno, job;

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL)                                                                                                                               
---------- ------------------ ---------- ---------- ---------- ----------                                                                                                                               
        10 CLERK                       1       1300       1300       1300                                                                                                                               
        10 MANAGER                     1       2450       2450       2450                                                                                                                               
        10 PRESIDENT                   1       5000       5000       5000                                                                                                                               
        10                             3       5000       8750 2916.66667                                                                                                                               
        20 ANALYST                     2       3000       6000       3000                                                                                                                               
        20 CLERK                       2       1100       1900        950                                                                                                                               
        20 MANAGER                     1       2975       2975       2975                                                                                                                               
        20                             5       3000      10875       2175                                                                                                                               
        30 CLERK                       1        950        950        950                                                                                                                               
        30 MANAGER                     1       2850       2850       2850                                                                                                                               
        30 SALESMAN                    4       1600       5609    1402.25                                                                                                                               
        30                             6       2850       9409 1568.16667                                                                                                                               
           ANALYST                     2       3000       6000       3000                                                                                                                               
           CLERK                       4       1300       4150     1037.5                                                                                                                               
           MANAGER                     3       2975       8275 2758.33333                                                                                                                               
           PRESIDENT                   1       5000       5000       5000                                                                                                                               
           SALESMAN                    4       1600       5609    1402.25                                                                                                                               

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL)                                                                                                                               
---------- ------------------ ---------- ---------- ---------- ----------                                                                                                                               
                                      14       5000      29034 2073.85714                                                                                                                               

18 rows selected.

SQL> select deptno, job, count(*)
  2  from emp
  3  group by deptno, rollup(job);

    DEPTNO JOB                  COUNT(*)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 CLERK                       1                                                                                                                                                                
        10 MANAGER                     1                                                                                                                                                                
        10 PRESIDENT                   1                                                                                                                                                                
        10                             3                                                                                                                                                                
        20 CLERK                       2                                                                                                                                                                
        20 ANALYST                     2                                                                                                                                                                
        20 MANAGER                     1                                                                                                                                                                
        20                             5                                                                                                                                                                
        30 CLERK                       1                                                                                                                                                                
        30 MANAGER                     1                                                                                                                                                                
        30 SALESMAN                    4                                                                                                                                                                
        30                             6                                                                                                                                                                

12 rows selected.

SQL> select deptno,job, count(*)
  2  from emp
  3  group by job, rollup(deptno);

    DEPTNO JOB                  COUNT(*)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 CLERK                       1                                                                                                                                                                
        20 CLERK                       2                                                                                                                                                                
        30 CLERK                       1                                                                                                                                                                
           CLERK                       4                                                                                                                                                                
        20 ANALYST                     2                                                                                                                                                                
           ANALYST                     2                                                                                                                                                                
        10 MANAGER                     1                                                                                                                                                                
        20 MANAGER                     1                                                                                                                                                                
        30 MANAGER                     1                                                                                                                                                                
           MANAGER                     3                                                                                                                                                                
        30 SALESMAN                    4                                                                                                                                                                
           SALESMAN                    4                                                                                                                                                                
        10 PRESIDENT                   1                                                                                                                                                                
           PRESIDENT                   1                                                                                                                                                                

14 rows selected.

SQL> select deptno, job, count(*)
  2  from emp
  3  group by grouping sets(deptno,job)
  4  order by deptno, job;

    DEPTNO JOB                  COUNT(*)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10                             3                                                                                                                                                                
        20                             5                                                                                                                                                                
        30                             6                                                                                                                                                                
           ANALYST                     2                                                                                                                                                                
           CLERK                       4                                                                                                                                                                
           MANAGER                     3                                                                                                                                                                
           PRESIDENT                   1                                                                                                                                                                
           SALESMAN                    4                                                                                                                                                                

8 rows selected.

SQL> select deptno, job, count(*), max(sal), sum(sal), avg(sal), grouping(deptno), grouping(job)
  2  from emp
  3  group by cube(deptno, job)
  4  order by deptno, job;

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL) GROUPING(DEPTNO) GROUPING(JOB)                                                                                                
---------- ------------------ ---------- ---------- ---------- ---------- ---------------- -------------                                                                                                
        10 CLERK                       1       1300       1300       1300                0             0                                                                                                
        10 MANAGER                     1       2450       2450       2450                0             0                                                                                                
        10 PRESIDENT                   1       5000       5000       5000                0             0                                                                                                
        10                             3       5000       8750 2916.66667                0             1                                                                                                
        20 ANALYST                     2       3000       6000       3000                0             0                                                                                                
        20 CLERK                       2       1100       1900        950                0             0                                                                                                
        20 MANAGER                     1       2975       2975       2975                0             0                                                                                                
        20                             5       3000      10875       2175                0             1                                                                                                
        30 CLERK                       1        950        950        950                0             0                                                                                                
        30 MANAGER                     1       2850       2850       2850                0             0                                                                                                
        30 SALESMAN                    4       1600       5609    1402.25                0             0                                                                                                
        30                             6       2850       9409 1568.16667                0             1                                                                                                
           ANALYST                     2       3000       6000       3000                1             0                                                                                                
           CLERK                       4       1300       4150     1037.5                1             0                                                                                                
           MANAGER                     3       2975       8275 2758.33333                1             0                                                                                                
           PRESIDENT                   1       5000       5000       5000                1             0                                                                                                
           SALESMAN                    4       1600       5609    1402.25                1             0                                                                                                

    DEPTNO JOB                  COUNT(*)   MAX(SAL)   SUM(SAL)   AVG(SAL) GROUPING(DEPTNO) GROUPING(JOB)                                                                                                
---------- ------------------ ---------- ---------- ---------- ---------- ---------------- -------------                                                                                                
                                      14       5000      29034 2073.85714                1             1                                                                                                

18 rows selected.

SQL> select deptno, listagg(ename, ', ')
  2  within group(order by sal desc) as enames
  3  from emp
  4  group by deptno;

    DEPTNO                                                                                                                                                                                              
----------                                                                                                                                                                                              
ENAMES                                                                                                                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        10                                                                                                                                                                                              
KING, CLARK, MILLER                                                                                                                                                                                     
                                                                                                                                                                                                        
        20                                                                                                                                                                                              
FORD, SCOTT, JONES, ADAMS, SMITH                                                                                                                                                                        
                                                                                                                                                                                                        
        30                                                                                                                                                                                              
BLAKE, ALLEN, TURNER, WARD, MARTIN, JAMES                                                                                                                                                               
                                                                                                                                                                                                        

SQL> select *
  2  from(select deptno, job, sal from emp)
  3  pivot(max(sal) for deptno in (10, 20, 30))
  4  order by job;

JOB                        10         20         30                                                                                                                                                     
------------------ ---------- ---------- ----------                                                                                                                                                     
ANALYST                             3000                                                                                                                                                                
CLERK                    1300       1100        950                                                                                                                                                     
MANAGER                  2450       2975       2850                                                                                                                                                     
PRESIDENT                5000                                                                                                                                                                           
SALESMAN                                       1600                                                                                                                                                     

SQL> 
SQL> --ex 7-35
SQL> select deptno,job,max(sal)
  2  from emp
  3  group by deptno, job
  4  order by deptno, job;

    DEPTNO JOB                  MAX(SAL)                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 CLERK                    1300                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        10 PRESIDENT                5000                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        20 CLERK                    1100                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 CLERK                     950                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                
        30 SALESMAN                 1600                                                                                                                                                                

9 rows selected.

SQL> select *
  2  from(select deptno,
  3  MAX(DECODE(job, 'CLERK' , SAL)) AS "CLERK",
  4  MAX(DECODE(JOB, 'SALESMAN', SAL)) AS "SALESMAN",
  5  MAX(DECODE(JOB, 'PRESIDENT', SAL)) AS "PRESIDENT",
  6  MAX(DECODE(JOB, 'MANAGER' , SAL)) AS "MANAGER",
  7  MAX(DECODE(JOB, ANALYST , SAL)) AS "ANALYST"
  8  FROM EMP
  9  GROUP BY DEPTNO
 10  ORDER BY DEPTNO)
 11  UNPIVOT(
 12  SAL FOR JOB IN (CLERK, SALESMAN, PRESIDENT, MANAGER, ANALYST))
 13  ORDER BY DEPTNO, JOB;
MAX(DECODE(JOB, ANALYST , SAL)) AS "ANALYST"
                *
ERROR at line 7:
ORA-00904: "ANALYST": invalid identifier 


SQL> SELECT *
  2  FROM(SELECT DEPTNO,
  3  MAX(DECODE(JOB, 'CLERK'      , SAL)) AS "CLERK",
  4  MAX(DECODE(JOB, 'SALESMAN', SAL)) AS "SALESMAN",
  5  MAX(DECODE(JOB, 'PRESIDENT', SAL)) AS "PRESIDENT",
  6  MAX(DECODE(JOB, 'MANAGER', SAL)) AS "MANAGER",
  7  MAX(DECODE(JOB, 'ANALYST' , SAL)) AS "ANALYST"
  8  FROM EMP
  9  GROUP BY DEPTNO
 10  ORDER BY DEPTNO)
 11  UNPIVOT(
 12  SAL FOR JOB IN (CLERK, SALESMAN, PRESIDENT, MANAGER, ANALYST))
 13  ORDER BY DEPTNO, JOB;

    DEPTNO JOB                       SAL                                                                                                                                                                
---------- ------------------ ----------                                                                                                                                                                
        10 CLERK                    1300                                                                                                                                                                
        10 MANAGER                  2450                                                                                                                                                                
        10 PRESIDENT                5000                                                                                                                                                                
        20 ANALYST                  3000                                                                                                                                                                
        20 CLERK                    1100                                                                                                                                                                
        20 MANAGER                  2975                                                                                                                                                                
        30 CLERK                     950                                                                                                                                                                
        30 MANAGER                  2850                                                                                                                                                                
        30 SALESMAN                 1600                                                                                                                                                                

9 rows selected.

SQL> select *
  2  from(select deptno, avg(sal)as avg_sal, max(sal) as max_sal ,min(sal) as min_sal , count(*) as cnt
  3  from emp
  4  group by deptno
  5  order by deptno);

    DEPTNO    AVG_SAL    MAX_SAL    MIN_SAL        CNT                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
        10 2916.66667       5000       1300          3                                                                                                                                                  
        20       2175       3000        800          5                                                                                                                                                  
        30 1568.16667       2850        950          6                                                                                                                                                  

SQL> select *
  2  from(select deptno, avg(sal)as avg_sal, max(sal) as max_sal ,min(sal) as min_sal , count(*) as cnt
  3  from emp
  4  group by deptno
  5  order by deptno desc);

    DEPTNO    AVG_SAL    MAX_SAL    MIN_SAL        CNT                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
        30 1568.16667       2850        950          6                                                                                                                                                  
        20       2175       3000        800          5                                                                                                                                                  
        10 2916.66667       5000       1300          3                                                                                                                                                  

SQL> select *
  2  from(select deptno, round(avg(sal))as avg_sal, max(sal) as max_sal ,min(sal) as min_sal , count(*) as cnt
  3  from emp
  4  group by deptno
  5  order by deptno desc);

    DEPTNO    AVG_SAL    MAX_SAL    MIN_SAL        CNT                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
        30       1568       2850        950          6                                                                                                                                                  
        20       2175       3000        800          5                                                                                                                                                  
        10       2917       5000       1300          3                                                                                                                                                  

SQL> select *
  2  from(select deptno, trunc(avg(sal))as avg_sal, max(sal) as max_sal ,min(sal) as min_sal , count(*) as cnt
  3  from emp
  4  group by deptno
  5  order by deptno desc);

    DEPTNO    AVG_SAL    MAX_SAL    MIN_SAL        CNT                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
        30       1568       2850        950          6                                                                                                                                                  
        20       2175       3000        800          5                                                                                                                                                  
        10       2916       5000       1300          3                                                                                                                                                  

SQL> select *
  2  from(select job, count(*)
  3   from emp
  4   group by job
  5   having count(*) >= 3);

JOB                  COUNT(*)                                                                                                                                                                           
------------------ ----------                                                                                                                                                                           
CLERK                       4                                                                                                                                                                           
SALESMAN                    4                                                                                                                                                                           
MANAGER                     3                                                                                                                                                                           

SQL> select *
  2  from(select deptno,
  3   to_char(hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno, hiredate) );

    DEPTNO HIRE_DAT        CNT    MAX_SAL    SUM_SAL  ASAVG_SAL                                                                                                                                         
---------- -------- ---------- ---------- ---------- ----------                                                                                                                                         
        10 1981              1       2450       2450       2450                                                                                                                                         
        10 1981              1       5000       5000       5000                                                                                                                                         
        10 1982              1       1300       1300       1300                                                                                                                                         
        10                   3       5000       8750 2916.66667                                                                                                                                         
        20 1980              1        800        800        800                                                                                                                                         
        20 1981              1       2975       2975       2975                                                                                                                                         
        20 1981              1       3000       3000       3000                                                                                                                                         
        20 1987              1       3000       3000       3000                                                                                                                                         
        20 1987              1       1100       1100       1100                                                                                                                                         
        20                   5       3000      10875       2175                                                                                                                                         
        30 1981              1       1600       1600       1600                                                                                                                                         
        30 1981              1       1259       1259       1259                                                                                                                                         
        30 1981              1       2850       2850       2850                                                                                                                                         
        30 1981              1       1500       1500       1500                                                                                                                                         
        30 1981              1       1250       1250       1250                                                                                                                                         
        30 1981              1        950        950        950                                                                                                                                         
        30                   6       2850       9409 1568.16667                                                                                                                                         

    DEPTNO HIRE_DAT        CNT    MAX_SAL    SUM_SAL  ASAVG_SAL                                                                                                                                         
---------- -------- ---------- ---------- ---------- ----------                                                                                                                                         
                            14       5000      29034 2073.85714                                                                                                                                         

18 rows selected.

SQL> select *
  2  from(select deptno,
  3   to_char(distinct(hiredate), 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno, hiredate) );
 to_char(distinct(hiredate), 'YYYY') as hire_date,
         *
ERROR at line 3:
ORA-00936: missing expression 


SQL> select *
  2  from(select deptno,
  3   to_char(hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno) );
 to_char(hiredate, 'YYYY') as hire_date,
         *
ERROR at line 3:
ORA-00979: not a GROUP BY expression 


SQL> select *
  2  from(select deptno,
  3   to_char(distinct hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno, hiredate) );
 to_char(distinct hiredate, 'YYYY') as hire_date,
         *
ERROR at line 3:
ORA-00936: missing expression 


SQL> select *
  2  from(select deptno,
  3   to_char(hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno, hiredate) );

    DEPTNO HIRE_DAT        CNT    MAX_SAL    SUM_SAL  ASAVG_SAL                                                                                                                                         
---------- -------- ---------- ---------- ---------- ----------                                                                                                                                         
        10 1981              1       2450       2450       2450                                                                                                                                         
        10 1981              1       5000       5000       5000                                                                                                                                         
        10 1982              1       1300       1300       1300                                                                                                                                         
        10                   3       5000       8750 2916.66667                                                                                                                                         
        20 1980              1        800        800        800                                                                                                                                         
        20 1981              1       2975       2975       2975                                                                                                                                         
        20 1981              1       3000       3000       3000                                                                                                                                         
        20 1987              1       3000       3000       3000                                                                                                                                         
        20 1987              1       1100       1100       1100                                                                                                                                         
        20                   5       3000      10875       2175                                                                                                                                         
        30 1981              1       1600       1600       1600                                                                                                                                         
        30 1981              1       1259       1259       1259                                                                                                                                         
        30 1981              1       2850       2850       2850                                                                                                                                         
        30 1981              1       1500       1500       1500                                                                                                                                         
        30 1981              1       1250       1250       1250                                                                                                                                         
        30 1981              1        950        950        950                                                                                                                                         
        30                   6       2850       9409 1568.16667                                                                                                                                         

    DEPTNO HIRE_DAT        CNT    MAX_SAL    SUM_SAL  ASAVG_SAL                                                                                                                                         
---------- -------- ---------- ---------- ---------- ----------                                                                                                                                         
                            14       5000      29034 2073.85714                                                                                                                                         

18 rows selected.

SQL> select *
  2  from(select deptno,
  3   distinct to_char(hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno, hiredate) );
 distinct to_char(hiredate, 'YYYY') as hire_date,
 *
ERROR at line 3:
ORA-00936: missing expression 


SQL> select *
  2  from(select deptno,
  3   to_char(hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) asavg_sal
  7  from emp
  8  group by rollup(deptno, to_char(hiredate, 'YYYY')) );

    DEPTNO HIRE_DAT        CNT    MAX_SAL    SUM_SAL  ASAVG_SAL                                                                                                                                         
---------- -------- ---------- ---------- ---------- ----------                                                                                                                                         
        10 1981              2       5000       7450       3725                                                                                                                                         
        10 1982              1       1300       1300       1300                                                                                                                                         
        10                   3       5000       8750 2916.66667                                                                                                                                         
        20 1980              1        800        800        800                                                                                                                                         
        20 1981              2       3000       5975     2987.5                                                                                                                                         
        20 1987              2       3000       4100       2050                                                                                                                                         
        20                   5       3000      10875       2175                                                                                                                                         
        30 1981              6       2850       9409 1568.16667                                                                                                                                         
        30                   6       2850       9409 1568.16667                                                                                                                                         
                            14       5000      29034 2073.85714                                                                                                                                         

10 rows selected.

SQL> --연습문제 5번
SQL> select *
  2  from(select deptno,
  3   to_char(hiredate, 'YYYY') as hire_date,
  4   count(*) as cnt, max(sal) as max_sal,
  5   sum(sal) as sum_sal,
  6   avg(sal) as avg_sal
  7  from emp
  8  group by rollup(deptno, to_char(hiredate, 'YYYY')) );

    DEPTNO HIRE_DAT        CNT    MAX_SAL    SUM_SAL    AVG_SAL                                                                                                                                         
---------- -------- ---------- ---------- ---------- ----------                                                                                                                                         
        10 1981              2       5000       7450       3725                                                                                                                                         
        10 1982              1       1300       1300       1300                                                                                                                                         
        10                   3       5000       8750 2916.66667                                                                                                                                         
        20 1980              1        800        800        800                                                                                                                                         
        20 1981              2       3000       5975     2987.5                                                                                                                                         
        20 1987              2       3000       4100       2050                                                                                                                                         
        20                   5       3000      10875       2175                                                                                                                                         
        30 1981              6       2850       9409 1568.16667                                                                                                                                         
        30                   6       2850       9409 1568.16667                                                                                                                                         
                            14       5000      29034 2073.85714                                                                                                                                         

10 rows selected.

SQL> select deptno, empno, ename, sal
  2  from emp
  3  where ename = 'JONES';

    DEPTNO      EMPNO ENAME                       SAL                                                                                                                                                   
---------- ---------- -------------------- ----------                                                                                                                                                   
        20       7566 JONES                      2975                                                                                                                                                   

SQL> select deptno, empno, ename, sal
  2  from emp
  3  where deptno = (
  4  select deptno
  5  from emp
  6  where ename = 'JONES');

    DEPTNO      EMPNO ENAME                       SAL                                                                                                                                                   
---------- ---------- -------------------- ----------                                                                                                                                                   
        20       7369 SMITH                       800                                                                                                                                                   
        20       7566 JONES                      2975                                                                                                                                                   
        20       7788 SCOTT                      3000                                                                                                                                                   
        20       7876 ADAMS                      1100                                                                                                                                                   
        20       7902 FORD                       3000                                                                                                                                                   

SQL> select mgr
  2  from emp;

       MGR                                                                                                                                                                                              
----------                                                                                                                                                                                              
      7902                                                                                                                                                                                              
      7698                                                                                                                                                                                              
      7698                                                                                                                                                                                              
      7839                                                                                                                                                                                              
      7698                                                                                                                                                                                              
      7839                                                                                                                                                                                              
      7839                                                                                                                                                                                              
      7566                                                                                                                                                                                              
                                                                                                                                                                                                        
      7698                                                                                                                                                                                              
      7788                                                                                                                                                                                              
      7698                                                                                                                                                                                              
      7566                                                                                                                                                                                              
      7782                                                                                                                                                                                              

14 rows selected.

SQL> select dept
  2  from emp;
select dept
       *
ERROR at line 1:
ORA-00904: "DEPT": invalid identifier 


SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                 
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                 

14 rows selected.

SQL> select ename, job
  2  from emp
  3  where job = (
  4  select job
  5  from emp
  6  where ename = 'JONES');

ENAME                JOB                                                                                                                                                                                
-------------------- ------------------                                                                                                                                                                 
JONES                MANAGER                                                                                                                                                                            
BLAKE                MANAGER                                                                                                                                                                            
CLARK                MANAGER                                                                                                                                                                            

SQL> select ename, job
  2  from emp
  3  where sal = (
  4  select sal
  5  from emp
  6  where ename = 'CLARK');

ENAME                JOB                                                                                                                                                                                
-------------------- ------------------                                                                                                                                                                 
CLARK                MANAGER                                                                                                                                                                            

SQL> select ename, job
  2  from emp
  3  where sal >= (
  4  select sal
  5  from emp
  6  where ename = 'CLARK');

ENAME                JOB                                                                                                                                                                                
-------------------- ------------------                                                                                                                                                                 
JONES                MANAGER                                                                                                                                                                            
BLAKE                MANAGER                                                                                                                                                                            
CLARK                MANAGER                                                                                                                                                                            
SCOTT                ANALYST                                                                                                                                                                            
KING                 PRESIDENT                                                                                                                                                                          
FORD                 ANALYST                                                                                                                                                                            

6 rows selected.

SQL> select ename, job, sal
  2  from emp
  3  where sal > (
  4  select sal
  5  from emp
  6  where ename = 'CLARK');

ENAME                JOB                       SAL                                                                                                                                                      
-------------------- ------------------ ----------                                                                                                                                                      
JONES                MANAGER                  2975                                                                                                                                                      
BLAKE                MANAGER                  2850                                                                                                                                                      
SCOTT                ANALYST                  3000                                                                                                                                                      
KING                 PRESIDENT                5000                                                                                                                                                      
FORD                 ANALYST                  3000                                                                                                                                                      

SQL> select ename, sal
  2  from emp
  3  where sal < (
  4  select avg(sal)
  5  from emp);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
SMITH                       800                                                                                                                                                                         
ALLEN                      1600                                                                                                                                                                         
WARD                       1259                                                                                                                                                                         
MARTIN                     1250                                                                                                                                                                         
TURNER                     1500                                                                                                                                                                         
ADAMS                      1100                                                                                                                                                                         
JAMES                       950                                                                                                                                                                         
MILLER                     1300                                                                                                                                                                         

8 rows selected.

SQL> select avg(sal)
  2  from emp;

  AVG(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
2073.85714                                                                                                                                                                                              

SQL> select avg(sal)
  2  from emp
  3  where deptno = 30;

  AVG(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
1568.16667                                                                                                                                                                                              

SQL> select avg(sal)
  2  from emp
  3  groupby deptno;
groupby deptno
        *
ERROR at line 3:
ORA-00933: SQL command not properly ended 


SQL> select avg(sal), deptno
  2  from emp
  3  groupby deptno;
groupby deptno
        *
ERROR at line 3:
ORA-00933: SQL command not properly ended 


SQL> select avg(sal), deptno
  2  from emp
  3  group by deptno;

  AVG(SAL)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
1568.16667         30                                                                                                                                                                                   
      2175         20                                                                                                                                                                                   
2916.66667         10                                                                                                                                                                                   

SQL> select avg(sal), deptno
  2  from emp
  3  group by deptno
  4  where avg(sal) > (
  5  select avg(sal)
  6  from emp
  7  where deptno = 30);
where avg(sal) > (
*
ERROR at line 4:
ORA-00933: SQL command not properly ended 


SQL> select avg(sal), deptno
  2  from emp
  3  group by deptno
  4  having avg(sal) > (
  5  select avg(sal)
  6  from emp
  7  where deptno = 30);

  AVG(SAL)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
      2175         20                                                                                                                                                                                   
2916.66667         10                                                                                                                                                                                   

SQL> select min(ename)
  2  from emp
  3  group by deptno;

MIN(ENAME)                                                                                                                                                                                              
--------------------                                                                                                                                                                                    
ALLEN                                                                                                                                                                                                   
ADAMS                                                                                                                                                                                                   
CLARK                                                                                                                                                                                                   

SQL> select ename, sal, deptno
  2  from emp
  3  where ename in (
  4  select min(ename)
  5  from emp
  6  group by deptno) ;

ENAME                       SAL     DEPTNO                                                                                                                                                              
-------------------- ---------- ----------                                                                                                                                                              
ALLEN                      1600         30                                                                                                                                                              
CLARK                      2450         10                                                                                                                                                              
ADAMS                      1100         20                                                                                                                                                              

SQL> select ename
  2  from emp;

ENAME                                                                                                                                                                                                   
--------------------                                                                                                                                                                                    
SMITH                                                                                                                                                                                                   
ALLEN                                                                                                                                                                                                   
WARD                                                                                                                                                                                                    
JONES                                                                                                                                                                                                   
MARTIN                                                                                                                                                                                                  
BLAKE                                                                                                                                                                                                   
CLARK                                                                                                                                                                                                   
SCOTT                                                                                                                                                                                                   
KING                                                                                                                                                                                                    
TURNER                                                                                                                                                                                                  
ADAMS                                                                                                                                                                                                   
JAMES                                                                                                                                                                                                   
FORD                                                                                                                                                                                                    
MILLER                                                                                                                                                                                                  

14 rows selected.

SQL> select ename, deptno
  2  from emp;

ENAME                    DEPTNO                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
SMITH                        20                                                                                                                                                                         
ALLEN                        30                                                                                                                                                                         
WARD                         30                                                                                                                                                                         
JONES                        20                                                                                                                                                                         
MARTIN                       30                                                                                                                                                                         
BLAKE                        30                                                                                                                                                                         
CLARK                        10                                                                                                                                                                         
SCOTT                        20                                                                                                                                                                         
KING                         10                                                                                                                                                                         
TURNER                       30                                                                                                                                                                         
ADAMS                        20                                                                                                                                                                         
JAMES                        30                                                                                                                                                                         
FORD                         20                                                                                                                                                                         
MILLER                       10                                                                                                                                                                         

14 rows selected.

SQL> select ename, sal, deptno
  2  from emp
  3  where ename in (
  4  select min(ename)
  5  from emp
  6  group by deptno) ;

ENAME                       SAL     DEPTNO                                                                                                                                                              
-------------------- ---------- ----------                                                                                                                                                              
ALLEN                      1600         30                                                                                                                                                              
CLARK                      2450         10                                                                                                                                                              
ADAMS                      1100         20                                                                                                                                                              

SQL> select sal
  2  from emp
  3  where deptno = 30;

       SAL                                                                                                                                                                                              
----------                                                                                                                                                                                              
      1600                                                                                                                                                                                              
      1259                                                                                                                                                                                              
      1250                                                                                                                                                                                              
      2850                                                                                                                                                                                              
      1500                                                                                                                                                                                              
       950                                                                                                                                                                                              

6 rows selected.

SQL> select *
  2  from emp;

     EMPNO ENAME                JOB                       MGR HIREDATE        SAL       COMM     DEPTNO                                                                                                 
---------- -------------------- ------------------ ---------- -------- ---------- ---------- ----------                                                                                                 
      7369 SMITH                CLERK                    7902 80/12/17        800                    20                                                                                                 
      7499 ALLEN                SALESMAN                 7698 81/02/20       1600        300         30                                                                                                 
      7521 WARD                 SALESMAN                 7698 81/02/22       1259        500         30                                                                                                 
      7566 JONES                MANAGER                  7839 81/04/02       2975                    20                                                                                                 
      7654 MARTIN               SALESMAN                 7698 81/09/28       1250       1400         30                                                                                                 
      7698 BLAKE                MANAGER                  7839 81/05/01       2850                    30                                                                                                 
      7782 CLARK                MANAGER                  7839 81/06/09       2450                    10                                                                                                 
      7788 SCOTT                ANALYST                  7566 87/04/19       3000                    20                                                                                                 
      7839 KING                 PRESIDENT                     81/11/17       5000                    10                                                                                                 
      7844 TURNER               SALESMAN                 7698 81/09/08       1500          0         30                                                                                                 
      7876 ADAMS                CLERK                    7788 87/05/23       1100                    20                                                                                                 
      7900 JAMES                CLERK                    7698 81/12/03        950                    30                                                                                                 
      7902 FORD                 ANALYST                  7566 81/12/03       3000                    20                                                                                                 
      7934 MILLER               CLERK                    7782 82/01/23       1300                    10                                                                                                 

14 rows selected.

SQL> select ename, sal
  2  from emp
  3  where sal > any(
  4  select sal
  5  from emp
  6  where deptno = 30);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
KING                       5000                                                                                                                                                                         
FORD                       3000                                                                                                                                                                         
SCOTT                      3000                                                                                                                                                                         
JONES                      2975                                                                                                                                                                         
BLAKE                      2850                                                                                                                                                                         
CLARK                      2450                                                                                                                                                                         
ALLEN                      1600                                                                                                                                                                         
TURNER                     1500                                                                                                                                                                         
MILLER                     1300                                                                                                                                                                         
WARD                       1259                                                                                                                                                                         
MARTIN                     1250                                                                                                                                                                         
ADAMS                      1100                                                                                                                                                                         

12 rows selected.

SQL> select ename, sal
  2  from emp
  3  where sal < any(
  4  select sal
  5  from emp
  6  where deptno = 30);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
SMITH                       800                                                                                                                                                                         
JAMES                       950                                                                                                                                                                         
ADAMS                      1100                                                                                                                                                                         
MARTIN                     1250                                                                                                                                                                         
WARD                       1259                                                                                                                                                                         
MILLER                     1300                                                                                                                                                                         
TURNER                     1500                                                                                                                                                                         
ALLEN                      1600                                                                                                                                                                         
CLARK                      2450                                                                                                                                                                         

9 rows selected.

SQL> where deptno = 30);
SP2-0734: unknown command beginning "where dept..." - rest of line ignored.
SQL> select ename, sal
  2  from emp
  3  where sal < any(
  4  select sal
  5  from emp
  6  where deptno = 30);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
SMITH                       800                                                                                                                                                                         
JAMES                       950                                                                                                                                                                         
ADAMS                      1100                                                                                                                                                                         
MARTIN                     1250                                                                                                                                                                         
WARD                       1259                                                                                                                                                                         
MILLER                     1300                                                                                                                                                                         
TURNER                     1500                                                                                                                                                                         
ALLEN                      1600                                                                                                                                                                         
CLARK                      2450                                                                                                                                                                         

9 rows selected.

SQL> select ename, sal
  2  from emp
  3  where sal > any(
  4  select sal
  5  from emp
  6  where deptno = 30);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
KING                       5000                                                                                                                                                                         
FORD                       3000                                                                                                                                                                         
SCOTT                      3000                                                                                                                                                                         
JONES                      2975                                                                                                                                                                         
BLAKE                      2850                                                                                                                                                                         
CLARK                      2450                                                                                                                                                                         
ALLEN                      1600                                                                                                                                                                         
TURNER                     1500                                                                                                                                                                         
MILLER                     1300                                                                                                                                                                         
WARD                       1259                                                                                                                                                                         
MARTIN                     1250                                                                                                                                                                         
ADAMS                      1100                                                                                                                                                                         

12 rows selected.

SQL> select sal
  2  from emp
  3  where deptno = 30;

       SAL                                                                                                                                                                                              
----------                                                                                                                                                                                              
      1600                                                                                                                                                                                              
      1259                                                                                                                                                                                              
      1250                                                                                                                                                                                              
      2850                                                                                                                                                                                              
      1500                                                                                                                                                                                              
       950                                                                                                                                                                                              

6 rows selected.

SQL> select ename, sal
  2  from emp
  3  where sal > all(
  4  select sal
  5  from emp
  6  where deptno = 30);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
JONES                      2975                                                                                                                                                                         
SCOTT                      3000                                                                                                                                                                         
FORD                       3000                                                                                                                                                                         
KING                       5000                                                                                                                                                                         

SQL> select ename, sal
  2  from emp
  3  where sal < all(
  4  select sal
  5  from emp
  6  where deptno = 30);

ENAME                       SAL                                                                                                                                                                         
-------------------- ----------                                                                                                                                                                         
SMITH                       800                                                                                                                                                                         

SQL> spool off
